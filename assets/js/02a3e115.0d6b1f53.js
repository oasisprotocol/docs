"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[9845],{28453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>t});var i=s(96540);const d={},r=i.createContext(d);function o(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:o(e.components),i.createElement(r.Provider,{value:n},e.children)}},62657:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"build/rofl/features/manifest","title":"rofl.yaml Manifest File","description":"Metadata","source":"@site/docs/build/rofl/features/manifest.md","sourceDirName":"build/rofl/features","slug":"/build/rofl/features/manifest","permalink":"/build/rofl/features/manifest","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/oasis-sdk/edit/main/docs/rofl/features/manifest.md","tags":[],"version":"current","lastUpdatedAt":1761563757000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"developers","previous":{"title":"Persistent Storage","permalink":"/build/rofl/features/storage"},"next":{"title":"appd REST API","permalink":"/build/rofl/features/appd"}}');var d=s(74848),r=s(28453);const o={sidebar_custom_props:{tags:void 0}},t="rofl.yaml Manifest File",l={},c=[{value:"Metadata",id:"metadata",level:2},{value:"App Resources (<code>resources</code>)",id:"resources",level:2},{value:"Memory (<code>memory</code>)",id:"resources-memory",level:3},{value:"vCPU Count (<code>cpus</code>)",id:"resources-cpu",level:3},{value:"Storage (<code>storage</code>)",id:"resources-storage",level:3},{value:"Deployments (<code>deployments</code>)",id:"deployments-deployments",level:2},{value:"<code>&lt;deployment name&gt;</code>",id:"deployment-name",level:3},{value:"<code>policy</code>",id:"policy",level:4}];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsxs)(n.h1,{id:"roflyaml-manifest-file",children:[(0,d.jsx)(n.code,{children:"rofl.yaml"})," Manifest File"]})}),"\n",(0,d.jsx)(n.h2,{id:"metadata",children:"Metadata"}),"\n",(0,d.jsx)(n.p,{children:"The following fields are valid in your yaml root:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"name"}),": A short, human-readabe name for your app. e.g. ",(0,d.jsx)(n.code,{children:"my-app"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"version"}),": ROFL version. e.g. ",(0,d.jsx)(n.code,{children:"0.1.1"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"repository"}),": A path to the git repository. e.g.\n",(0,d.jsx)(n.code,{children:"https://github.com/user/my-app"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"author"}),": The author name and their e-mail address. e.g.\n",(0,d.jsx)(n.code,{children:"John Doe <john@doe.com>"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"license"}),": The ROFL license in ",(0,d.jsx)(n.a,{href:"https://spdx.org/licenses/",children:"SPDX"})," format. e.g. ",(0,d.jsx)(n.code,{children:"Apache-2.0"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"tee"}),": The Trusted Execution Environment type. Valid options are ",(0,d.jsx)(n.code,{children:"tdx"}),"\n(default) or ",(0,d.jsx)(n.code,{children:"sgx"})]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"kind"}),': The ROFL "flavor". Valid options for TDX TEE are ',(0,d.jsx)(n.code,{children:"containers"}),"\n(default) or ",(0,d.jsx)(n.code,{children:"raw"}),". The only valid option for SGX TEE is ",(0,d.jsx)(n.code,{children:"raw"})]}),"\n"]}),"\n",(0,d.jsxs)(n.h2,{id:"resources",children:["App Resources (",(0,d.jsx)(n.code,{children:"resources"}),")"]}),"\n",(0,d.jsx)(n.p,{children:"Each containerized app running in ROFL must define what kind of resources it\nneeds for its execution. This includes the number of assigned vCPUs, amount of\nmemory, storage requirements, GPUs, etc."}),"\n",(0,d.jsxs)(n.p,{children:["Resources are specified in the app manifest file under the ",(0,d.jsx)(n.code,{children:"resources"})," section\nas follows:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",children:"resources:\n  memory: 512\n  cpus: 1\n  storage:\n    kind: disk-persistent\n    size: 512\n"})}),"\n",(0,d.jsx)(n.p,{children:"This chapter describes the set of supported resources."}),"\n",(0,d.jsx)(n.admonition,{type:"warning",children:(0,d.jsx)(n.p,{children:"Changing the requested resources will result in a different enclave identity of\nthe app and will require the policy to be updated!"})}),"\n",(0,d.jsxs)(n.h3,{id:"resources-memory",children:["Memory (",(0,d.jsx)(n.code,{children:"memory"}),")"]}),"\n",(0,d.jsxs)(n.p,{children:["The amount of memory is specified in megabytes. By default the this value is\ninitialized to ",(0,d.jsx)(n.code,{children:"512"}),"."]}),"\n",(0,d.jsxs)(n.h3,{id:"resources-cpu",children:["vCPU Count (",(0,d.jsx)(n.code,{children:"cpus"}),")"]}),"\n",(0,d.jsxs)(n.p,{children:["The number of vCPUs allocated to the VM. By default this value is initialized to\n",(0,d.jsx)(n.code,{children:"1"}),"."]}),"\n",(0,d.jsxs)(n.h3,{id:"resources-storage",children:["Storage (",(0,d.jsx)(n.code,{children:"storage"}),")"]}),"\n",(0,d.jsxs)(n.p,{children:["Each app running in ROFL can request different storage options, depending on its\nuse case. The storage kind is specified in the ",(0,d.jsx)(n.code,{children:"kind"})," field with the following\nvalues currently supported:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"disk-persistent"})," provisions a persistent disk of the given size. The disk is\nencrypted and authenticated using a key derived by the decentralized on-chain\nkey management system after successful attestation."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"disk-ephemeral"})," provisions an ephemeral disk of the given size. The disk is\nencrypted and authenticated using an ephemeral key randomly generated on each\nboot."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"ram"})," provisions an ephemeral filesystem entirely contained in encrypted\nmemory."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"none"})," does not provision any kind of storage. Specifying this option will not\nwork for containerized apps."]}),"\n"]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["The ",(0,d.jsx)(n.code,{children:"size"})," argument defines the amount of storage to provision in megabytes."]}),"\n",(0,d.jsxs)(n.h2,{id:"deployments-deployments",children:["Deployments (",(0,d.jsx)(n.code,{children:"deployments"}),")"]}),"\n",(0,d.jsx)(n.p,{children:"This section contains ROFL deployments on specific networks."}),"\n",(0,d.jsx)(n.h3,{id:"deployment-name",children:(0,d.jsx)(n.code,{children:"<deployment name>"})}),"\n",(0,d.jsx)(n.h4,{id:"policy",children:(0,d.jsx)(n.code,{children:"policy"})}),"\n",(0,d.jsx)(n.p,{children:"Contains the policy under which the app will be allowed to spin up:"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"quotes"}),": defines a TEE-specific policy requirements such as the TCB validity\nperiod, and the minimum TCB-R number which indicates what security updates\nmust be applied to the given platform."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"enclaves"}),": defines the allowed enclave IDs for running this app."]}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"endorsements"}),": a list of conditions that define who can run this app."]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"- any: {}"}),": any node is allowed to run the app."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"- node: <node_id>"}),": node with a specific node ID is allowed to run the app."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"- provider: <address>"}),": nodes belonging to the specified ROFL provider\nare allowed to run the app."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"- provider_instance_admin: <address>"}),": machines having the specified admin\nare allowed to run the app."]}),"\n"]}),"\n",(0,d.jsxs)(n.p,{children:["You can also nest conditions with ",(0,d.jsx)(n.code,{children:"and"})," and ",(0,d.jsx)(n.code,{children:"or"})," operators. For example:"]}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-yaml",metastring:'title="policy.yaml"',children:"endorsements:\n  - and:\n    - provider: oasis1qp2ens0hsp7gh23wajxa4hpetkdek3swyyulyrmz\n    - or:\n      - provider_instance_admin: oasis1qrk58a6j2qn065m6p06jgjyt032f7qucy5wqeqpt\n      - provider_instance_admin: oasis1qqcd0qyda6gtwdrfcqawv3s8cr2kupzw9v967au6\n"})}),"\n",(0,d.jsx)(n.p,{children:"In the example the app will only run on a specified provider and on machines\nowned by either of the two admin addresses."}),"\n"]}),"\n",(0,d.jsxs)(n.li,{children:["\n",(0,d.jsxs)(n.p,{children:[(0,d.jsx)(n.code,{children:"fees: <fee_policy>"}),": who pays for the registration and other fees:"]}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"endorsing_node"}),": the node running the app pays the fees."]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.code,{children:"instance"}),": The app instance pays the fees."]}),"\n"]}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(a,{...e})}):a(e)}}}]);