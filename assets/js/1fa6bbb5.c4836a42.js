"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[2684],{28453:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var i=s(96540);const t={},o=i.createContext(t);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},66013:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"core/consensus/services/beacon","title":"Random Beacon","description":"The random beacon service is responsible for providing a source of unbiased","source":"@site/docs/core/consensus/services/beacon.md","sourceDirName":"core/consensus/services","slug":"/core/consensus/services/beacon","permalink":"/core/consensus/services/beacon","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/oasis-core/edit/stable/24.2.x/docs/consensus/services/beacon.md","tags":[],"version":"current","lastUpdatedAt":1757571245000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"oasisCore","previous":{"title":"Epoch Time","permalink":"/core/consensus/services/epochtime"},"next":{"title":"Staking","permalink":"/core/consensus/services/staking"}}');var t=s(74848),o=s(28453);const r={sidebar_custom_props:{tags:void 0}},a="Random Beacon",c={},d=[{value:"Operation",id:"operation",level:2},{value:"Commit Phase",id:"commit-phase",level:3},{value:"Reveal Phase",id:"reveal-phase",level:3},{value:"Complete (Transition Wait) Phase",id:"complete-transition-wait-phase",level:3},{value:"Methods",id:"methods",level:2},{value:"PVSS Commit",id:"pvss-commit",level:3},{value:"PVSS Reveal",id:"pvss-reveal",level:3},{value:"Consensus Parameters",id:"consensus-parameters",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"random-beacon",children:"Random Beacon"})}),"\n",(0,t.jsx)(n.p,{children:"The random beacon service is responsible for providing a source of unbiased\nrandomness on each epoch. It uses a commit-reveal scheme backed by a PVSS scheme\nsuch that as long as the threshold of participants is met, and one participant\nis honest, secure entropy will be generated."}),"\n",(0,t.jsxs)(n.p,{children:["The service interface definition lives in ",(0,t.jsx)(n.a,{href:"https://github.com/oasisprotocol/oasis-core/tree/master/go/beacon/api",children:(0,t.jsx)(n.code,{children:"go/beacon/api"})}),". It defines the\nsupported queries and transactions. For more information you can also check out\nthe ",(0,t.jsx)(n.a,{href:"https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/beacon/api?tab=doc",children:"consensus service API documentation"})," and the ",(0,t.jsx)(n.a,{href:"/adrs/0007-improved-random-beacon",children:"beacon ADR specification"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"operation",children:"Operation"}),"\n",(0,t.jsxs)(n.p,{children:["Each node generates and maintains a long term elliptic curve point and scalar\npair (public/private key pair), the point (public key) of which is included in\nthe node descriptor stored by the ",(0,t.jsx)(n.a,{href:"/core/consensus/services/registry",children:"registry service"}),". In the initial\nimplementation, the curve is P-256."]}),"\n",(0,t.jsxs)(n.p,{children:["The beacon generation process is split into three sequential stages.  Any\nfailures in the ",(0,t.jsx)(n.em,{children:"Commit"})," and ",(0,t.jsx)(n.em,{children:"Reveal"})," phases result in a failed protocol round,\nand the generation process will restart after disqualifying participants who\nhave induced the failure."]}),"\n",(0,t.jsx)(n.h3,{id:"commit-phase",children:"Commit Phase"}),"\n",(0,t.jsxs)(n.p,{children:["Upon epoch transition or a prior failed round the commit phase is initiated and\nthe consensus service will select ",(0,t.jsx)(n.code,{children:"participants"})," nodes from the current\nvalidator set (in order of descending stake) to serve as entropy contributors."]}),"\n",(0,t.jsxs)(n.p,{children:["The beacon state is (re)-initialized, and an event is broadcast to signal to the\nparticipants that they should generate and submit their encrypted shares via a\n",(0,t.jsx)(n.code,{children:"beacon.SCRAPECommit"})," transaction."]}),"\n",(0,t.jsxs)(n.p,{children:["Each commit phase lasts exactly ",(0,t.jsx)(n.code,{children:"commit_interval"})," blocks, at the end of which,\nthe round will be closed to further commits."]}),"\n",(0,t.jsxs)(n.p,{children:["At the end of the commit phase, the protocol state is evaluated to ensure that\n",(0,t.jsx)(n.code,{children:"threshold"})," of nodes have published encrypted shares, and if an insufficient\nnumber of nodes have published them, the round is considered to have failed."]}),"\n",(0,t.jsx)(n.p,{children:"The following behaviors are currently candidates for a node being marked as\nmalicious/non-particpatory and subject to exclusion from future rounds and\nslashing:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Not submitting a commitment."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Malformed commitments (corrupted/fails to validate/etc)."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Attempting to alter an existing commitment for a given epoch/round."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"reveal-phase",children:"Reveal Phase"}),"\n",(0,t.jsxs)(n.p,{children:["When the ",(0,t.jsx)(n.code,{children:"commit_interval"})," has passed, assuming that a sufficient number of\ncommits have been received, the consensus service transitions into the reveal\nphase and broadcasts an event to signal to the participants that they should\nreveal the decrypted values of the encrypted shares received from other\nparticipants via a ",(0,t.jsx)(n.code,{children:"beacon.PVSSReveal"})," transaction."]}),"\n",(0,t.jsxs)(n.p,{children:["Each reveal phase lasts exactly ",(0,t.jsx)(n.code,{children:"reveal_interval"})," blocks, at the end of which,\nthe round will be closed to further reveals."]}),"\n",(0,t.jsxs)(n.p,{children:["At the end of the reveal phase, the protocol state is evaluated to ensure that\n",(0,t.jsx)(n.code,{children:"threshold"})," nodes have published decrypted shares, and if an insufficient number\nof nodes have published in either case, the round is considered to have failed."]}),"\n",(0,t.jsx)(n.p,{children:"The following behaviors are currently candidates for a node being marked as\nmalicious/non-participatory and subject to exclusion from future rounds and\nslashing:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Not submitting a reveal."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Malformed commitments (corrupted/fails to validate/etc)."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Attempting to alter an existing reveal for a given Epoch/Round."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"complete-transition-wait-phase",children:"Complete (Transition Wait) Phase"}),"\n",(0,t.jsxs)(n.p,{children:["When the ",(0,t.jsx)(n.code,{children:"reveal_interval"})," has passed, assuming that a sufficient number of\nreveals have been received, the beacon service recovers the final entropy output\n(the hash of the secret shared by each participant) and transitions into the\ncomplete (transition wait) phase and broadcasting an event to signal to\nparticipants the completion of the round."]}),"\n",(0,t.jsx)(n.p,{children:"No meaningful protocol activity happens once a round has successfully completed,\nbeyond the scheduling of the next epoch transition."}),"\n",(0,t.jsx)(n.h2,{id:"methods",children:"Methods"}),"\n",(0,t.jsx)(n.p,{children:"The following sections describe the methods supported by the consensus beacon\nservice. Note that the methods can only be called by validators and only when\nthey are the block proposer."}),"\n",(0,t.jsx)(n.h3,{id:"pvss-commit",children:"PVSS Commit"}),"\n",(0,t.jsx)(n.p,{children:"Submits a PVSS commit."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Method name:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"beacon.PVSSCommit\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-golang",children:'type PVSSCommit struct {\n    Epoch EpochTime `json:"epoch"`\n    Round uint64    `json:"round"`\n\n    Commit *pvss.Commit `json:"commit,omitempty"`\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"pvss-reveal",children:"PVSS Reveal"}),"\n",(0,t.jsx)(n.p,{children:"Submits a PVSS reveal."}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Method name:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"beacon.PVSSReveal\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Body:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-golang",children:'type PVSSReveal struct {\n    Epoch EpochTime `json:"epoch"`\n    Round uint64    `json:"round"`\n\n    Reveal *pvss.Reveal `json:"reveal,omitempty"`\n}\n'})}),"\n",(0,t.jsx)(n.h2,{id:"consensus-parameters",children:"Consensus Parameters"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"participants"})," is the number of participants to be selected for each beacon\ngeneration protocol round."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"threshold"})," is the minimum number of participants which must successfully\ncontribute entropy for the final output to be considered valid. This is also\nthe minimum number of participants that are required to reconstruct a PVSS\nsecret from the corresponding decrypted shares."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"commit_interval"})," is the duration of the ",(0,t.jsx)(n.em,{children:"Commit"})," phase, in blocks."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"reveal_interval"})," is the duration of the ",(0,t.jsx)(n.em,{children:"Reveal"})," phase, in blocks."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"transition_delay"})," is the duration of the post ",(0,t.jsx)(n.em,{children:"Reveal"})," phase delay, in\nblocks."]}),"\n"]}),"\n"]})]})}function l(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);