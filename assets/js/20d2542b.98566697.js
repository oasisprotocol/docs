"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[9508],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>l});var i=s(96540);const o={},r=i.createContext(o);function t(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),i.createElement(r.Provider,{value:n},e.children)}},51141:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"core/development-setup/prerequisites","title":"Prerequisites","description":"The following is a list of prerequisites required to start developing on Oasis","source":"@site/docs/core/development-setup/prerequisites.md","sourceDirName":"core/development-setup","slug":"/core/development-setup/prerequisites","permalink":"/core/development-setup/prerequisites","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/oasis-core/edit/stable/24.2.x/docs/development-setup/prerequisites.md","tags":[],"version":"current","lastUpdatedAt":1757571245000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"oasisCore","previous":{"title":"Build Environment Setup and Building","permalink":"/core/development-setup/build-environment-setup-and-building"},"next":{"title":"Building","permalink":"/core/development-setup/building"}}');var o=s(74848),r=s(28453);const t={sidebar_custom_props:{tags:void 0}},l="Prerequisites",c={},d=[{value:"Using the Development Docker Image",id:"using-the-development-docker-image",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"prerequisites",children:"Prerequisites"})}),"\n",(0,o.jsx)(n.p,{children:"The following is a list of prerequisites required to start developing on Oasis\nCore:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["Linux (if you are not on Linux, you will need to either set up a VM with the\nproper environment or, if Docker is available for your platform, use the\nprovided Docker image which does this for you,\n",(0,o.jsx)(n.a,{href:"#using-the-development-docker-image",children:"see below"}),")."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"System packages:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/projectatomic/bubblewrap",children:"Bubblewrap"})," (at least version 0.3.3)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"http://gcc.gnu.org/",children:"GCC"})," (including C++ subpackage)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://clang.llvm.org/",children:"Clang"})," (including development package)."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/protocolbuffers/protobuf",children:"Protobuf"})," compiler."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://www.gnu.org/software/make/",children:"GNU Make"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://cmake.org/",children:"CMake"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://www.freedesktop.org/wiki/Software/pkg-config",children:"pkg-config"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://www.openssl.org/",children:"OpenSSL"})," development package."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"https://github.com/seccomp/libseccomp",children:"libseccomp"})," development package."]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.em,{children:["NOTE: On Ubuntu/Debian systems, compiling ",(0,o.jsx)(n.a,{href:"https://github.com/fortanix/rust-mbedtls",children:"mbedtls"})," crate when building the\n",(0,o.jsx)(n.code,{children:"oasis-core-runtime"})," binary requires having the ",(0,o.jsx)(n.code,{children:"gcc-multilib"})," package\ninstalled."]})}),"\n",(0,o.jsx)(n.p,{children:"On Fedora 29+, you can install all the above with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo dnf install bubblewrap gcc gcc-c++ clang-devel clang protobuf-compiler make cmake openssl-devel libseccomp-devel pkg-config\n"})}),"\n",(0,o.jsxs)(n.p,{children:["On Ubuntu 18.10+ (18.04 LTS provides overly-old ",(0,o.jsx)(n.code,{children:"bubblewrap"}),"), you can install\nall the above with:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo apt install bubblewrap gcc g++ gcc-multilib libclang-dev clang protobuf-compiler make cmake libssl-dev libseccomp-dev pkg-config\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://golang.org",children:"Go"})," (at least version 1.25.0)."]}),"\n",(0,o.jsx)(n.p,{children:"If your distribution provides a new-enough version of Go, just use that."}),"\n",(0,o.jsx)(n.p,{children:"Please note that if you want to compile Oasis Core v22.1.9 or earlier,\nthen go >=1.19 is not supported yet; you need to use 1.18.x."}),"\n",(0,o.jsx)(n.p,{children:"Otherwise:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"install the Go version provided by your distribution,"}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsxs)(n.a,{href:"https://tip.golang.org/doc/code.html#GOPATH",children:["ensure ",(0,o.jsx)(n.code,{children:"$GOPATH/bin"})," is in your ",(0,o.jsx)(n.code,{children:"PATH"})]}),","]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://golang.org/doc/install#extra_versions",children:"install the desired version of Go"}),", e.g. 1.25.0, with:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"go install golang.org/dl/go1.25.0@latest\ngo1.25.0 download\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["instruct the build system to use this particular version of Go by setting\nthe ",(0,o.jsx)(n.code,{children:"OASIS_GO"})," environment variable in your ",(0,o.jsx)(n.code,{children:"~/.bashrc"}),":"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"export OASIS_GO=go1.25.0\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://www.rust-lang.org/",children:"Rust"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["We follow ",(0,o.jsx)(n.a,{href:"https://www.rust-lang.org/tools/install",children:"Rust upstream's recommendation"})," on using\n",(0,o.jsx)(n.a,{href:"https://rustup.rs/",children:"rustup"})," to install and manage Rust versions."]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"NOTE: rustup cannot be installed alongside a distribution packaged Rust\nversion. You will need to remove it (if it's present) before you can start\nusing rustup."})}),"\n",(0,o.jsx)(n.p,{children:"Install it by running:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.em,{children:["NOTE: If you want to avoid directly executing a shell script fetched the\ninternet, you can also ",(0,o.jsxs)(n.a,{href:"https://github.com/rust-lang/rustup#other-installation-methods",children:["download ",(0,o.jsx)(n.code,{children:"rustup-init"})," executable for your platform"]}),"\nand run it manually."]})}),"\n",(0,o.jsxs)(n.p,{children:["This will run ",(0,o.jsx)(n.code,{children:"rustup-init"})," which will download and install the latest stable\nversion of Rust on your system."]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.a,{href:"https://edp.fortanix.com",children:"Fortanix Rust EDP"})," utilities."]}),"\n",(0,o.jsx)(n.p,{children:"Install the Fortanix Rust EDP utilities by running:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"cargo install fortanix-sgx-tools\ncargo install sgxs-tools\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsx)(n.p,{children:"Oasis Core's Rust toolchain version with Fortanix SGX target."}),"\n",(0,o.jsxs)(n.p,{children:["The version of the Rust toolchain we use in Oasis Core is specified in the\n",(0,o.jsx)(n.a,{href:"https://github.com/oasisprotocol/oasis-core/tree/master/rust-toolchain.toml",children:(0,o.jsx)(n.code,{children:"rust-toolchain.toml"})})," file."]}),"\n",(0,o.jsxs)(n.p,{children:["The rustup-installed versions of ",(0,o.jsx)(n.code,{children:"cargo"}),", ",(0,o.jsx)(n.code,{children:"rustc"})," and other tools will\n",(0,o.jsx)(n.a,{href:"https://github.com/rust-lang/rustup/blob/master/README.md#override-precedence",children:"automatically detect this file and use the appropriate version of the Rust\ntoolchain"})," when invoked from the Oasis core git\ncheckout directory."]}),"\n",(0,o.jsx)(n.p,{children:"To install the appropriate version of the Rust toolchain, make sure you are\nin an Oasis Core git checkout directory and run:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"rustup show\n"})}),"\n",(0,o.jsx)(n.p,{children:"This will automatically install the appropriate Rust toolchain (if not\npresent) and output something similar to:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"...\n\nactive toolchain\n----------------\n\nnightly-2024-01-08-x86_64-unknown-linux-gnu (overridden by '/code/rust-toolchain.toml')\nrustc 1.77.0-nightly (75c68cfd2 2024-01-07)\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["(",(0,o.jsx)(n.strong,{children:"OPTIONAL"}),") ",(0,o.jsx)(n.a,{href:"https://github.com/mvdan/gofumpt",children:"gofumpt"})," and ",(0,o.jsx)(n.a,{href:"https://pkg.go.dev/golang.org/x/tools/cmd/goimports",children:"goimports"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Required if you plan to change any of the Go code in order for automated code\nformatting (",(0,o.jsx)(n.code,{children:"make fmt"}),") to work."]}),"\n",(0,o.jsx)(n.p,{children:"Download and install it with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"${OASIS_GO:-go} install mvdan.cc/gofumpt@v0.8.0\n${OASIS_GO:-go} install golang.org/x/tools/cmd/goimports@v0.36.0\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["(",(0,o.jsx)(n.strong,{children:"OPTIONAL"}),") ",(0,o.jsx)(n.a,{href:"https://golangci-lint.run/",children:"golangci-lint"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Required if you plan to change any of the Go code in order for automated code\nlinting (",(0,o.jsx)(n.code,{children:"make lint"}),") to work."]}),"\n",(0,o.jsx)(n.p,{children:"Download and install it with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"curl -sSfL \\\nhttps://raw.githubusercontent.com/golangci/golangci-lint/master/install.sh \\\n | sh -s -- -b $(${OASIS_GO:-go} env GOPATH)/bin v2.3.1\n"})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["(",(0,o.jsx)(n.strong,{children:"OPTIONAL"}),") ",(0,o.jsx)(n.a,{href:"https://github.com/golang/protobuf",children:"protoc-gen-go"}),"."]}),"\n",(0,o.jsx)(n.p,{children:"Download and install it with:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"${OASIS_GO:-go} install google.golang.org/protobuf/cmd/protoc-gen-go@v1.21.0\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.em,{children:["NOTE: If you didn't/can't add ",(0,o.jsx)(n.code,{children:"$GOPATH/bin"})," to your ",(0,o.jsx)(n.code,{children:"PATH"}),", you can install\n",(0,o.jsx)(n.code,{children:"protoc-gen-go"})," to ",(0,o.jsx)(n.code,{children:"/usr/local/bin"})," (which is in ",(0,o.jsx)(n.code,{children:"$PATH"}),") with:"]})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"sudo GOBIN=/usr/local/bin ${OASIS_GO:-go} install google.golang.org/protobuf/cmd/protoc-gen-go@v1.21.0\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.em,{children:"NOTE: The repository has the most up-to-date files generated by protoc-gen-go\ncommitted for convenience.  Installing protoc-gen-go is only required if you\nare a developer making changes to protobuf definitions used by Go."})}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["\n",(0,o.jsxs)(n.p,{children:["(",(0,o.jsx)(n.strong,{children:"OPTIONAL"}),") ",(0,o.jsx)(n.a,{href:"https://github.com/jemalloc/jemalloc",children:"jemalloc"})," (version 5.2.1, built with ",(0,o.jsx)(n.code,{children:"'je_'"})," jemalloc-prefix)"]}),"\n",(0,o.jsxs)(n.p,{children:["Alternatively set ",(0,o.jsx)(n.code,{children:"OASIS_BADGER_NO_JEMALLOC=1"})," environment variable when\nbuilding ",(0,o.jsx)(n.code,{children:"oasis-node"})," code, to build ",(0,o.jsx)(n.a,{href:"https://github.com/dgraph-io/badger/",children:"BadgerDB"})," without ",(0,o.jsx)(n.code,{children:"jemalloc"})," support."]}),"\n",(0,o.jsxs)(n.p,{children:["Download and install ",(0,o.jsx)(n.code,{children:"jemalloc"})," with:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"JEMALLOC_VERSION=5.2.1\nJEMALLOC_CHECKSUM=34330e5ce276099e2e8950d9335db5a875689a4c6a56751ef3b1d8c537f887f6\nJEMALLOC_GITHUB=https://github.com/jemalloc/jemalloc/releases/download/\npushd $(mktemp -d)\nwget \\\n  -O jemalloc.tar.bz2 \\\n  \"${JEMALLOC_GITHUB}/${JEMALLOC_VERSION}/jemalloc-${JEMALLOC_VERSION}.tar.bz2\"\n# Ensure checksum matches.\necho \"${JEMALLOC_CHECKSUM} jemalloc.tar.bz2\" | sha256sum -c\ntar -xf jemalloc.tar.bz2\ncd jemalloc-${JEMALLOC_VERSION}\n# Ensure reproducible jemalloc build.\n# https://reproducible-builds.org/docs/build-path/\nEXTRA_CXXFLAGS=-ffile-prefix-map=$(pwd -L)=. \\\n  EXTRA_CFLAGS=-ffile-prefix-map=$(pwd -L)=. \\\n  ./configure \\\n    --with-jemalloc-prefix='je_' \\\n    --with-malloc-conf='background_thread:true,metadata_thp:auto'\nmake\nsudo make install\npopd\n"})}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsxs)(n.em,{children:["NOTE: jemalloc needs to be installed to the (default) ",(0,o.jsx)(n.code,{children:"/usr/local"})," prefix\n(i.e. you can't use ",(0,o.jsx)(n.code,{children:"./configure --prefix=$HOME/.local ..."}),") because upstream\nauthors ",(0,o.jsx)(n.a,{href:"https://github.com/dgraph-io/ristretto/blob/221ca9b2091d12e5d24aa5d7d56e49745fc175d8/z/calloc_jemalloc.go#L9-L13",children:"hardcode its path"}),"."]})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"In the following instructions, the top-level directory is the directory\nwhere the code has been checked out."}),"\n",(0,o.jsx)(n.h2,{id:"using-the-development-docker-image",children:"Using the Development Docker Image"}),"\n",(0,o.jsxs)(n.p,{children:["If for some reason you don't want or can't install the specified prerequisites\non the host system, you can use our development Docker image. This requires that\nyou have a ",(0,o.jsx)(n.a,{href:"https://docs.docker.com/install/",children:"recent version of Docker installed"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["Oasis development environment with all the dependencies preinstalled is\navailable in the ",(0,o.jsx)(n.code,{children:"ghcr.io/oasisprotocol/oasis-core-dev:master"})," image.\nTo run a container, do the following in the top-level directory:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"make docker-shell\n"})}),"\n",(0,o.jsx)(n.p,{children:"If you are curious, this target will internally run the following command:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"docker run -t -i \\\n  --name oasis-core \\\n  --security-opt apparmor:unconfined \\\n  --security-opt seccomp=unconfined \\\n  -v $(pwd):/code \\\n  -w /code \\\n  ghcr.io/oasisprotocol/oasis-core-dev:master \\\n  bash\n"})}),"\n",(0,o.jsx)(n.p,{children:"All the following commands can then be used from inside the container. See the\nDocker documentation for detailed instructions on working with Docker\ncontainers."})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(a,{...e})}):a(e)}}}]);