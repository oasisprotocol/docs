"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[4037],{8346:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/rofl-compose-app-wrap-f6183037c3fe0e28c60d639c8b1c302d.svg"},11470:(e,t,n)=>{n.d(t,{A:()=>k});var a=n(96540),r=n(34164),o=n(17559),s=n(23104),l=n(56347),i=n(205),u=n(57485),c=n(31682),d=n(70679);function p(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:t,children:n}=e;return(0,a.useMemo)(()=>{const e=t??function(e){return p(e).map(({props:{value:e,label:t,attributes:n,default:a}})=>({value:e,label:t,attributes:n,default:a}))}(n);return function(e){const t=(0,c.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function f({value:e,tabValues:t}){return t.some(t=>t.value===e)}function m({queryString:e=!1,groupId:t}){const n=(0,l.W6)(),r=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,u.aZ)(r),(0,a.useCallback)(e=>{if(!r)return;const t=new URLSearchParams(n.location.search);t.set(r,e),n.replace({...n.location,search:t.toString()})},[r,n])]}function b(e){const{defaultValue:t,queryString:n=!1,groupId:r}=e,o=h(e),[s,l]=(0,a.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:o})),[u,c]=m({queryString:n,groupId:r}),[p,b]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,r]=(0,d.Dv)(t);return[n,(0,a.useCallback)(e=>{t&&r.set(e)},[t,r])]}({groupId:r}),g=(()=>{const e=u??p;return f({value:e,tabValues:o})?e:null})();(0,i.A)(()=>{g&&l(g)},[g]);return{selectedValue:s,selectValue:(0,a.useCallback)(e=>{if(!f({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);l(e),c(e),b(e)},[c,b,o]),tabValues:o}}var g=n(92303);const v={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=n(74848);function y({className:e,block:t,selectedValue:n,selectValue:a,tabValues:o}){const l=[],{blockElementScrollPositionUntilNextRender:i}=(0,s.a_)(),u=e=>{const t=e.currentTarget,r=l.indexOf(t),s=o[r].value;s!==n&&(i(t),a(s))},c=e=>{let t=null;switch(e.key){case"Enter":u(e);break;case"ArrowRight":{const n=l.indexOf(e.currentTarget)+1;t=l[n]??l[0];break}case"ArrowLeft":{const n=l.indexOf(e.currentTarget)-1;t=l[n]??l[l.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,r.A)("tabs",{"tabs--block":t},e),children:o.map(({value:e,label:t,attributes:a})=>(0,x.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{l.push(e)},onKeyDown:c,onClick:u,...a,className:(0,r.A)("tabs__item",v.tabItem,a?.className,{"tabs__item--active":n===e}),children:t??e},e))})}function w({lazy:e,children:t,selectedValue:n}){const o=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===n);return e?(0,a.cloneElement)(e,{className:(0,r.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:o.map((e,t)=>(0,a.cloneElement)(e,{key:t,hidden:e.props.value!==n}))})}function j(e){const t=b(e);return(0,x.jsxs)("div",{className:(0,r.A)(o.G.tabs.container,"tabs-container",v.tabList),children:[(0,x.jsx)(y,{...t,...e}),(0,x.jsx)(w,{...t,...e})]})}function k(e){const t=(0,g.A)();return(0,x.jsx)(j,{...e,children:p(e.children)},String(t))}},19365:(e,t,n)=>{n.d(t,{A:()=>s});n(96540);var a=n(34164);const r={tabItem:"tabItem_Ymn6"};var o=n(74848);function s({children:e,hidden:t,className:n}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.A)(r.tabItem,n),hidden:t,children:e})}},28453:(e,t,n)=>{n.d(t,{R:()=>s,x:()=>l});var a=n(96540);const r={},o=a.createContext(r);function s(e){const t=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(o.Provider,{value:t},e.children)}},95642:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>u,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"build/rofl/workflow/build","title":"Build","description":"This operation packs compose.yaml, specific operating system components and","source":"@site/docs/build/rofl/workflow/build.mdx","sourceDirName":"build/rofl/workflow","slug":"/build/rofl/workflow/build","permalink":"/build/rofl/workflow/build","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/oasis-sdk/edit/main/docs/rofl/workflow/build.mdx","tags":[],"version":"current","lastUpdatedAt":1761563757000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"developers","previous":{"title":"Create","permalink":"/build/rofl/workflow/create"},"next":{"title":"Deploy","permalink":"/build/rofl/workflow/deploy"}}');var r=n(74848),o=n(28453),s=n(11470),l=n(19365);const i={sidebar_custom_props:{tags:void 0}},u="Build",c={},d=[{value:"Update On-chain App Config",id:"update-on-chain-app-config",level:2}];function p(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"build",children:"Build"})}),"\n",(0,r.jsxs)(t.p,{children:["This operation packs ",(0,r.jsx)(t.code,{children:"compose.yaml"}),", specific operating system components and\nthe hash of a trusted block on the Sapphire chain. All these pieces are needed\nto safely execute our app inside a TEE."]}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.img,{alt:"ROFL-compose-app bundle wrapper",src:n(8346).A+""})}),"\n",(0,r.jsx)(t.p,{children:"Whenever you make changes to your app and want to deploy it, you first need\nto build it. The build process takes the compose file together with other ROFL\nartifacts and deterministically generates a bundle that can later be\ndeployed."}),"\n",(0,r.jsxs)(t.p,{children:["The build process also computes the ",(0,r.jsx)(t.em,{children:"enclave identity"})," of the bundle which is\nused during the process of remote attestation to authenticate the app instances\nbefore granting them access to the key management system and ",(0,r.jsx)(t.a,{href:"../features/",children:"other features"}),"."]}),"\n",(0,r.jsx)(t.p,{children:"To build an app and update the enclave identity in the app manifest, simply run:"}),"\n",(0,r.jsxs)(s.A,{children:[(0,r.jsx)(l.A,{value:"Native Linux",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"oasis rofl build\n"})})}),(0,r.jsx)(l.A,{value:"Docker (Windows, Mac, Linux)",children:(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"docker run --platform linux/amd64 --volume .:/src -it ghcr.io/oasisprotocol/rofl-dev:main oasis rofl build\n"})})})]}),"\n",(0,r.jsx)(t.p,{children:"This will generate a ROFL bundle which can be used for later deployment and\noutput something like:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{children:"ROFL app built and bundle written to 'myapp.default.orc'.\n"})}),"\n",(0,r.jsx)(t.h2,{id:"update-on-chain-app-config",children:"Update On-chain App Config"}),"\n",(0,r.jsxs)(t.p,{children:["After any changes to the ",(0,r.jsx)(t.a,{href:"/build/rofl/features/manifest#policy",children:"app's policy"})," defined in the manifest, the on-chain\napp config needs to be updated in order for the changes to take effect."]}),"\n",(0,r.jsx)(t.p,{children:"The designated admin account is able to update this policy by issuing an update\ntransaction which can be done via the CLI by running:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-shell",children:"oasis rofl update\n"})})]})}function h(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}}}]);