"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[3684],{21524:(e,n,t)=>{t.d(n,{A:()=>x});t(96540);var i=t(34164),s=t(28774),o=t(26972),r=t(53465),a=t(16654),d=(t(21312),t(51107));const l={cardContainer:"cardContainer_S8oU",cardTitle:"cardTitle_HoSo",cardDescription:"cardDescription_c27F"};var c=t(74848);function h({href:e,children:n}){return(0,c.jsx)(s.A,{href:e,className:(0,i.A)("card padding--lg",l.cardContainer),children:n})}function u({href:e,icon:n,title:t,description:s,customProps:o}){return(0,c.jsxs)(h,{href:e,children:[(0,c.jsx)(d.A,{as:"h3",className:(0,i.A)("text--truncate",l.cardTitle),title:t,children:t}),s&&(0,c.jsx)("p",{className:(0,i.A)("text--truncate",l.cardDescription),title:s,children:s}),o?.tags&&Array.isArray(o.tags)?(0,c.jsx)("div",{className:"pill",children:o.tags.map(e=>(0,c.jsx)("div",{className:"pills__item pills__item--active tag ",children:e},e))}):null]})}function p({item:e}){const n=(0,o.Nr)(e);!function(){const{selectMessage:e}=(0,r.W)()}();return n?(0,c.jsx)(u,{href:n,icon:"\ud83d\uddc3\ufe0f",title:e.label,description:e.description,customProps:e.customProps}):null}function y({item:e}){const n=(0,a.A)(e.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",t=(0,o.cC)(e.docId??void 0);return(0,c.jsx)(u,{href:e.href,icon:n,title:e.label,description:e.description??t?.description,customProps:e.customProps})}function x({item:e}){switch(e.type){case"link":return(0,c.jsx)(y,{item:e});case"category":return(0,c.jsx)(p,{item:e});default:throw new Error(`unknown item type ${JSON.stringify(e)}`)}}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var i=t(96540);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},29497:(e,n,t)=>{t.d(n,{A:()=>c});t(96540);var i=t(34164),s=t(26972),o=t(21524);const r={docCardListItem:"docCardListItem_W1sv"};var a=t(74848);function d({className:e}){const n=(0,s.a4)();return(0,a.jsx)(c,{items:n,className:e})}function l({item:e}){return(0,a.jsx)("article",{className:(0,i.A)(r.docCardListItem,"col col--6"),children:(0,a.jsx)(o.A,{item:e})})}function c(e){const{items:n,className:t}=e;if(!n)return(0,a.jsx)(d,{...e});const o=(0,s.d1)(n);return(0,a.jsx)("section",{className:(0,i.A)("row",t),children:o.map((e,n)=>(0,a.jsx)(l,{item:e},n))})}},53465:(e,n,t)=>{t.d(n,{W:()=>l});var i=t(96540),s=t(44586);const o=["zero","one","two","few","many","other"];function r(e){return o.filter(n=>e.includes(n))}const a={locale:"en",pluralForms:r(["one","other"]),select:e=>1===e?"one":"other"};function d(){const{i18n:{currentLocale:e}}=(0,s.A)();return(0,i.useMemo)(()=>{try{return function(e){const n=new Intl.PluralRules(e);return{locale:e,pluralForms:r(n.resolvedOptions().pluralCategories),select:e=>n.select(e)}}(e)}catch(n){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${n.message}\n`),a}},[e])}function l(){const e=d();return{selectMessage:(n,t)=>function(e,n,t){const i=e.split("|");if(1===i.length)return i[0];i.length>t.pluralForms.length&&console.error(`For locale=${t.locale}, a maximum of ${t.pluralForms.length} plural forms are expected (${t.pluralForms.join(",")}), but the message contains ${i.length}: ${e}`);const s=t.select(n),o=t.pluralForms.indexOf(s);return i[Math.min(o,i.length-1)]}(t,n,e)}}},56116:(e,n,t)=>{t.d(n,{$:()=>r});var i=t(23025),s=t(44586);function o(e){for(const n of e){const e=n.href;e&&void 0===globalThis.sidebarItemsMap[e]&&(globalThis.sidebarItemsMap[e]=n),"category"===n.type&&o(n.items)}}function r(e){const{siteConfig:n,siteMetadata:t}=(0,s.A)(),r=(0,i.r)();if(!r)throw new Error("Unexpected: cant find docsVersion in current context");if(void 0===globalThis.sidebarItemsMap){globalThis.sidebarItemsMap={};for(const e in r.docsSidebars)o(r.docsSidebars[e])}if(void 0===globalThis.sidebarItemsMap[e]){if(console.log(`Item ${e} not found. Registered sidebar items:`),console.log(globalThis.sidebarItemsMap),"throw"==n.onBrokenMarkdownLinks)throw new Error(`Unexpected: sidebar item with href ${e} does not exist.`);return globalThis.sidebarItemsMap["/general/"]}return globalThis.sidebarItemsMap[e]}},58416:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>p,frontMatter:()=>d,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"node/run-your-node/validator-node","title":"Validator Node","description":"This guide will walk you through the process of setting up your validator","source":"@site/docs/node/run-your-node/validator-node.mdx","sourceDirName":"node/run-your-node","slug":"/node/run-your-node/validator-node","permalink":"/node/run-your-node/validator-node","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/docs/edit/main/docs/node/run-your-node/validator-node.mdx","tags":[],"version":"current","lastUpdatedAt":1761867754000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"operators","previous":{"title":"Set up Trusted Execution Environment (TEE)","permalink":"/node/run-your-node/prerequisites/set-up-tee"},"next":{"title":"Non-validator Node","permalink":"/node/run-your-node/non-validator-node"}}');var s=t(74848),o=t(28453),r=t(29497),a=t(56116);const d={sidebar_custom_props:{tags:void 0}},l="Validator Node",c={},h=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Initialize Entity",id:"initialize-entity",level:2},{value:"Add Entity Account to Oasis CLI",id:"add-entity-account-to-oasis-cli",level:3},{value:"Write the Entity Descriptor File",id:"write-the-entity-descriptor-file",level:3},{value:"Configuration",id:"configuration",level:2},{value:"Starting the Oasis Node",id:"starting-the-oasis-node",level:2},{value:"Node Keys",id:"node-keys",level:3},{value:"Ensuring Proper Permissions",id:"ensuring-proper-permissions",level:3},{value:"Obtain the Node ID",id:"obtain-the-node-id",level:3},{value:"Check that your Node is Synced",id:"check-that-your-node-is-synced",level:3},{value:"Staking and Registering",id:"staking-and-registering",level:2},{value:"Staking (Escrow) Transaction",id:"staking-escrow-transaction",level:3},{value:"Add your Node ID to the Entity Descriptor",id:"add-your-node-id-to-the-entity-descriptor",level:3},{value:"Entity Registration",id:"entity-registration",level:3},{value:"Check that Your Node is Properly Registered",id:"check-that-your-node-is-properly-registered",level:3},{value:"Oasis Metadata Registry",id:"oasis-metadata-registry",level:2}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"validator-node",children:"Validator Node"})}),"\n",(0,s.jsxs)(n.p,{children:["This guide will walk you through the process of setting up your ",(0,s.jsx)(n.strong,{children:"validator\nnode"})," for the Oasis Network either on Mainnet or Testnet. It is designed for\nindividuals who have basic understanding of the command line environment."]}),"\n",(0,s.jsx)(n.p,{children:"We will be using two separate physical machines for deployment:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["your local system, referred to as ",(0,s.jsx)(n.code,{children:"localhost"}),","]}),"\n",(0,s.jsxs)(n.li,{children:["a remote ",(0,s.jsx)(n.code,{children:"server"})," which will function as an Oasis node."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"The guide consists of the following steps:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["On the ",(0,s.jsx)(n.code,{children:"localhost"}),", we will use ",(0,s.jsx)(n.a,{href:"/build/tools/cli/",children:"Oasis CLI"})," to ",(0,s.jsx)(n.a,{href:"#initialize-entity",children:"Initialize your\nEntity"})," which is essential for deploying nodes on the\nnetwork. To ensure the security of these private keys, we strongly recommend\nto either isolate the ",(0,s.jsx)(n.code,{children:"localhost"})," from any network or internet connectivity, or\nuse a ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Hardware_security_module",children:"hardware wallet"})," as a secure storage, such as ",(0,s.jsx)(n.a,{href:"../../../general/manage-tokens/holding-rose-tokens/ledger-wallet",children:"Ledger"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["After the entity has been created, we will move over to the ",(0,s.jsx)(n.code,{children:"server"})," and\n",(0,s.jsx)(n.a,{href:"#starting-the-oasis-node",children:"Start the Oasis Node"}),". The server needs to meet\nthe hardware requirements and have access to the internet."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Finally, we will ",(0,s.jsx)(n.a,{href:"#staking-and-registering",children:"stake assets to your entity, register it on the network,\nand attach the unique ID"})," of the\nOasis Node instance running on your server."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.p,{children:["Before proceeding with this guide, ensure that you have completed the steps\noutlined in the ",(0,s.jsx)(n.a,{href:"prerequisites/",children:"Prerequisites"})," chapter so that:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["your system meets the ",(0,s.jsx)(n.a,{href:"/node/run-your-node/prerequisites/hardware-recommendations",children:"hardware requirements"}),","]}),"\n",(0,s.jsxs)(n.li,{children:["you have the ",(0,s.jsx)(n.a,{href:"/build/tools/cli/",children:"Oasis CLI"})," installed on your ",(0,s.jsx)(n.code,{children:"localhost"}),","]}),"\n",(0,s.jsxs)(n.li,{children:["you have the ",(0,s.jsx)(n.a,{href:"/node/run-your-node/prerequisites/oasis-node",children:"Oasis Node binary"})," installed on your ",(0,s.jsx)(n.code,{children:"server"}),","]}),"\n",(0,s.jsxs)(n.li,{children:["you understand what are ",(0,s.jsx)(n.a,{href:"/node/run-your-node/prerequisites/stake-requirements",children:"Stake requirements"})," to become a validator on the\nOasis Network."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"initialize-entity",children:"Initialize Entity"}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["Everything in this section should be done on the ",(0,s.jsx)(n.code,{children:"localhost"})," as there are\nsensitive items that will be created."]})}),"\n",(0,s.jsx)(n.p,{children:"During the entity initialization process, you will generate essential components\nsuch as keys and other crucial artifacts that are necessary for the deployment\nof nodes on the network. This guide has been designed with a particular file\nstructure in mind. Nonetheless, feel free to reorganize and rename directories\nas needed to accommodate your preferences."}),"\n",(0,s.jsx)(n.h3,{id:"add-entity-account-to-oasis-cli",children:"Add Entity Account to Oasis CLI"}),"\n",(0,s.jsxs)(n.p,{children:["An entity is critical to operating nodes on the network as it controls the stake\nattached to a given individual or organization on the network. The entity is\nrepresented as a consensus-layer account using the Ed25519 signature scheme.\nTo protect your entity private key, we strongly recommend using a ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Hardware_security_module",children:"hardware\nwallet"})," such as ",(0,s.jsx)(n.a,{href:"../../../general/manage-tokens/holding-rose-tokens/ledger-wallet",children:"Ledger"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["We will be using ",(0,s.jsx)(n.a,{href:"/build/tools/cli/",children:"Oasis CLI"})," to initialize the entity and later stake our assets\nand register the entity on the network. If you haven't already, go ahead and\ninstall it."]}),"\n",(0,s.jsx)(n.p,{children:"Oasis CLI stores either your entity private key encrypted inside a file or a\nreference to an account whose keypair is stored on your hardware wallet."}),"\n",(0,s.jsx)(n.admonition,{type:"danger",children:(0,s.jsxs)(n.p,{children:["If you really need to use the file-based wallet using another\n",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Air_gap_(networking)",children:"offline/air-gapped machine"})," for this purpose is highly recommended. Gaining\naccess to the entity private key can compromise your tokens and the network\nsecurity through proposing and signing malicious governance transactions."]})}),"\n",(0,s.jsxs)(n.p,{children:["On the ",(0,s.jsx)(n.code,{children:"localhost"})," add a new entity account to Oasis CLI. This can be done in\none of the following ways:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create an account entry in Oasis CLI, but use your Ledger device to store\nthe actual keypair to sign the transactions by executing\n",(0,s.jsx)(n.a,{href:"/build/tools/cli/wallet#create",children:(0,s.jsx)(n.code,{children:"oasis wallet create"})})," and passing the ",(0,s.jsx)(n.code,{children:"--kind ledger"})," flag. For example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis wallet create my_entity --kind ledger\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Import your existing ",(0,s.jsx)(n.code,{children:"entity.pem"})," into Oasis CLI by executing\n",(0,s.jsx)(n.a,{href:"/build/tools/cli/wallet#import-file",children:(0,s.jsx)(n.code,{children:"oasis wallet import-file"})})," command, for example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis wallet import-file my_entity entity.pem\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Generate a new keypair and store the private key in the encrypted file by\nexecuting ",(0,s.jsx)(n.a,{href:"/build/tools/cli/wallet#create",children:(0,s.jsx)(n.code,{children:"oasis wallet create"})}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis wallet create my_entity\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Similar to the examples above we will assume that you named your entity account\nas ",(0,s.jsx)(n.strong,{children:(0,s.jsx)(n.code,{children:"my_entity"})})," in the remainder of this chapter."]}),"\n",(0,s.jsx)(n.h3,{id:"write-the-entity-descriptor-file",children:"Write the Entity Descriptor File"}),"\n",(0,s.jsxs)(n.p,{children:["On the ",(0,s.jsx)(n.code,{children:"localhost"})," we begin by creating a directory named ",(0,s.jsx)(n.code,{children:"/localhostdir"})," with\nthe ",(0,s.jsx)(n.code,{children:"entity"})," subdirectory that will contain the entity file descriptor."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"mkdir -p /localhostdir/entity\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Create a JSON file containing the ",(0,s.jsx)(n.strong,{children:"public key"})," of your entity by executing\n",(0,s.jsx)(n.a,{href:"/build/tools/cli/account#entity-init",children:(0,s.jsx)(n.code,{children:"oasis account entity init"})})," and store it as ",(0,s.jsx)(n.code,{children:"entity.json"}),", for example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis account entity init -o /localhostdir/entity/entity.json --account my_entity\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Now, we can move on to configuring our Oasis node with the information from\nfreshly generated ",(0,s.jsx)(n.code,{children:"entity.json"}),"."]}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsxs)(n.p,{children:["You can obtain your entity ID by running the ",(0,s.jsx)(n.code,{children:"cat entity.json"})," command and\nreading out the ",(0,s.jsx)(n.code,{children:"id"})," field."]}),(0,s.jsxs)(n.p,{children:["Alternatively, if your entity account is imported into the Oasis CLI you can use\nthe ",(0,s.jsx)(n.a,{href:"/build/tools/cli/wallet#show",children:(0,s.jsx)(n.code,{children:"oasis wallet show"})})," command. Your entity ID will be displayed in the\n",(0,s.jsx)(n.code,{children:"Public Key"})," field."]})]}),"\n",(0,s.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,s.jsx)(n.p,{children:"There are a variety of options available when running an Oasis node. The\nfollowing YAML file is a basic configuration for a validator node on the\nnetwork."}),"\n",(0,s.jsx)(n.p,{children:"Before using this configuration you should collect the following information to\nreplace the variables present in the configuration file:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"{{ external_ip }}"}),": The external/public IP address you used when registering\nthis node."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["If you are using a ",(0,s.jsx)(n.a,{href:"/node/run-your-node/sentry-node",children:"Sentry Node"}),", you should use the public IP\nof that machine."]})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"{{ seed_node_address }}"}),": The seed node address in the form ",(0,s.jsx)(n.code,{children:"ID@IP:port"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["You can find the current Oasis Seed Node address in the Network Parameters\npage (",(0,s.jsx)(n.a,{href:"/node/network/mainnet",children:"Mainnet"}),", ",(0,s.jsx)(n.a,{href:"/node/network/testnet",children:"Testnet"}),")."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"{{ entity_id }}"}),": The node's entity ID from ",(0,s.jsx)(n.code,{children:"entity.json"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["To use this configuration, save it in the ",(0,s.jsx)(n.code,{children:"/node/etc/config.yml"})," file:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",metastring:'title="/node/etc/config.yml"',children:'mode: validator\ncommon:\n    # Set this to where you wish to store node data. The node\'s artifacts\n    # should also be located in this directory.\n    data_dir: /node/data\n    # Logging.\n    #\n    # Per-module log levels are defined below. If you prefer just one unified\n    # log level, you can use:\n    #\n    # log:\n    #   level: debug\n    log:\n        level:\n            cometbft: warn\n            cometbft/context: error\n            # Per-module log levels. Longest prefix match will be taken.\n            # Fallback to "default", if no match.\n            default: debug\n        format: JSON\n        # By default logs are output to stdout. If you would like to output\n        # logs to a file, you can use:\n        #\n        # file: /var/log/oasis-node.log\n\nconsensus:\n    # The external IP that is used when registering this node to the network.\n    # NOTE: If you are using the Sentry node setup, this option should be\n    # omitted.\n    external_address: tcp://{{ external_ip }}:26656\n    listen_address: tcp://0.0.0.0:26656\n\ngenesis:\n    # Path to the genesis file for the current version of the network.\n    file: /node/etc/genesis.json\n\np2p:\n    port: 9200\n    registration:\n        addresses:\n            - {{ external_ip }}:9200\n    seeds:\n        # List of seed nodes to connect to.\n        # NOTE: You can add additional seed nodes to this list if you want.\n        - {{ seed_node_address }}\n\nregistration:\n    # In order for the node to register itself, the entity ID must be set.\n    entity_id: {{ entity_id }}\n'})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["Make sure the ",(0,s.jsx)(n.code,{children:"consensus"})," port (default: ",(0,s.jsx)(n.code,{children:"26656"}),") and ",(0,s.jsx)(n.code,{children:"p2p.port"})," (default: ",(0,s.jsx)(n.code,{children:"9200"}),") are exposed and publicly\naccessible on the internet (for ",(0,s.jsx)(n.code,{children:"TCP"})," and ",(0,s.jsx)(n.code,{children:"UDP"})," traffic)."]})}),"\n",(0,s.jsx)(n.h2,{id:"starting-the-oasis-node",children:"Starting the Oasis Node"}),"\n",(0,s.jsx)(n.p,{children:"You can start the node by simply running the command:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis-node --config /node/etc/config.yml\n"})}),"\n",(0,s.jsxs)(n.admonition,{type:"tip",children:[(0,s.jsx)(n.p,{children:"The Oasis node is configured to run in the foreground by default."}),(0,s.jsxs)(n.p,{children:["We recommend that you configure and use it with a process manager like\n",(0,s.jsx)(n.a,{href:"https://github.com/systemd/systemd",children:"systemd"})," or\n",(0,s.jsx)(n.a,{href:"http://supervisord.org",children:"Supervisor"}),". Check out the ",(0,s.jsx)(n.a,{href:"/node/run-your-node/prerequisites/system-configuration#create-a-user",children:"System Configuration"}),"\npage for examples."]})]}),"\n",(0,s.jsx)(n.h3,{id:"node-keys",children:"Node Keys"}),"\n",(0,s.jsxs)(n.p,{children:["The Oasis node requires ",(0,s.jsx)(n.strong,{children:"node keys"})," in order to register itself and to\nsecurely communicate with other nodes in the peer-to-peer network. The following\nkeys will automatically be generated and stored in your ",(0,s.jsx)(n.code,{children:"/node/data"})," folder\nas ",(0,s.jsx)(n.code,{children:".pem"})," files:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"consensus.pem"}),": The node's consensus private key. ",(0,s.jsx)(n.strong,{children:"DO NOT SHARE"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"consensus_pub.pem"}),": The node's consensus public key."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"identity.pem"}),": The node's identity private key. ",(0,s.jsx)(n.strong,{children:"DO NOT SHARE"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"identity_pub.pem"}),": The node's identity public key."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"p2p.pem"}),": The node's private key for libp2p. ",(0,s.jsx)(n.strong,{children:"DO NOT SHARE"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"p2p_pub.pem"}),": The node's public key for libp2p."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sentry_client_tls_identity.pem"}),": The node's TLS private key for communicating\nwith sentry nodes. ",(0,s.jsx)(n.strong,{children:"DO NOT SHARE"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sentry_client_tls_identity_cert.pem"}),": The node's TLS certificate for\ncommunicating with sentry nodes."]}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"If the node keys do not exist, they will be automatically generated when you\nlaunch the Oasis node. Otherwise, the existing ones will be used."})}),"\n",(0,s.jsxs)(n.admonition,{type:"caution",children:[(0,s.jsxs)(n.p,{children:["You may have noticed that some files above are listed as ",(0,s.jsx)(n.strong,{children:"DO NOT SHARE"}),"."]}),(0,s.jsxs)(n.p,{children:["Ideally, the node keys should be stored on a separate device such as a\n",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Hardware_security_module",children:"hardware wallet"})," or a ",(0,s.jsx)(n.a,{href:"/node/run-your-node/advanced/remote-signer",children:"remote signer"}),". However, until the support is\nfully implemented, keep the keys on the ",(0,s.jsx)(n.code,{children:"server"})," as secure as possible."]})]}),"\n",(0,s.jsx)(n.h3,{id:"ensuring-proper-permissions",children:"Ensuring Proper Permissions"}),"\n",(0,s.jsxs)(n.p,{children:["Only the owner of the process that runs the Oasis node should have access to the\nfiles in the ",(0,s.jsx)(n.code,{children:"/node/data"})," directory. The ",(0,s.jsx)(n.code,{children:"oasis-node"})," binary ensures that\nthe files used by the node are as least privileged as possible so that you don't\naccidentally shoot yourself in the foot while operating a node."]}),"\n",(0,s.jsxs)(n.p,{children:["If you followed the steps described in the\n",(0,s.jsx)(n.a,{href:"/node/run-your-node/prerequisites/oasis-node",children:"Install the Oasis Node"})," chapter, then the proper permissions\nare already set:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"700"})," for the ",(0,s.jsx)(n.code,{children:"/node/data"})," directory"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"700"})," for the ",(0,s.jsx)(n.code,{children:"/node/etc"})," directory"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"700"})," for the ",(0,s.jsx)(n.code,{children:"/node/runtimes"})," directory"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"600"})," for all ",(0,s.jsx)(n.code,{children:"/node/data/*.pem"})," files"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Otherwise, run the following to remove all non-owner read/write/execute\npermissions:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"chmod -R go-r,go-w,go-x /node\n"})}),"\n",(0,s.jsx)(n.h3,{id:"obtain-the-node-id",children:"Obtain the Node ID"}),"\n",(0,s.jsx)(n.p,{children:"Now that the Oasis node is running, you can obtain your unique node ID which is\nneeded in order to associate your node with your entity in the network registry."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis-node control status -a unix:/node/data/internal.sock | jq .identity.node\n"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'"5MsgQwijUlpH9+0Hbyors5jwmx7tTmKMA4c9leV3prI="\n'})}),"\n",(0,s.jsx)(n.h3,{id:"check-that-your-node-is-synced",children:"Check that your Node is Synced"}),"\n",(0,s.jsx)(n.p,{children:"Before you can become a validator, you will have to make sure that your node is\nsynced. To do so call this command on the server:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis-node control is-synced -a unix:/node/data/internal.sock\n"})}),"\n",(0,s.jsx)(n.p,{children:"If your node is synced, the above command should output:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'"ready"\n'})}),"\n",(0,s.jsx)(n.p,{children:"If your node is not yet synced, you will need to wait before you can move\nforward."}),"\n",(0,s.jsx)(n.h2,{id:"staking-and-registering",children:"Staking and Registering"}),"\n",(0,s.jsx)(n.p,{children:"Once you have been funded, you can complete the process of connecting your node\nto the network by registering both your entity and your node, as described\nbelow."}),"\n",(0,s.jsx)(n.h3,{id:"staking-escrow-transaction",children:"Staking (Escrow) Transaction"}),"\n",(0,s.jsxs)(n.p,{children:["The current minimum stake required to register an entity and register a node as\na validator is 200 tokens. We will submit the escrow transaction that\ndelegates 200 tokens from your entity account on the consensus layer to itself\nby invoking the ",(0,s.jsx)(n.a,{href:"/build/tools/cli/account#delegate",children:(0,s.jsx)(n.code,{children:"oasis account delegate"})})," command."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis account delegate 200 my_entity --no-paratime --account my_entity\n"})}),"\n",(0,s.jsxs)(n.p,{children:["You can also fund your entity account from a different one. If you haven't yet\ninvoke the ",(0,s.jsx)(n.a,{href:"/build/tools/cli/wallet#import",children:(0,s.jsx)(n.code,{children:"oasis wallet import"})})," command to import the private key of the\nfunding account to the Oasis CLI and follow the instructions."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis wallet import my_funding_account\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Then, invoke the ",(0,s.jsx)(n.a,{href:"/build/tools/cli/account#delegate",children:(0,s.jsx)(n.code,{children:"oasis account delegate"})})," passing the new account name with\nthe ",(0,s.jsx)(n.code,{children:"--account"})," parameter. For example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis account delegate 200 my_entity --no-paratime --account my_funding_account\n"})}),"\n",(0,s.jsx)(n.h3,{id:"add-your-node-id-to-the-entity-descriptor",children:"Add your Node ID to the Entity Descriptor"}),"\n",(0,s.jsxs)(n.p,{children:["Now we can register our entity on the network and associate it with the node ID\nobtained in the ",(0,s.jsx)(n.a,{href:"#obtain-the-node-id",children:"section above"}),". Open the ",(0,s.jsx)(n.code,{children:"entity.json"}),"\nfile we initially generated and add the ID inside the ",(0,s.jsx)(n.code,{children:"nodes"})," block. Your\nentity descriptor file should now look like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": "Bx6gOixnxy15tCs09ua5DcKyX9uo2Forb32O6Hyjoc8=",\n  "nodes": [\n    "5MsgQwijUlpH9+0Hbyors5jwmx7tTmKMA4c9leV3prI="\n  ],\n  "v": 2\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"entity-registration",children:"Entity Registration"}),"\n",(0,s.jsxs)(n.p,{children:["We can submit the fresh entity file descriptor by invoking the\n",(0,s.jsx)(n.a,{href:"/build/tools/cli/account#entity-register",children:(0,s.jsx)(n.code,{children:"oasis account entity register"})})," command:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis account entity register entity.json --account my_entity\n"})}),"\n",(0,s.jsx)(n.h3,{id:"check-that-your-node-is-properly-registered",children:"Check that Your Node is Properly Registered"}),"\n",(0,s.jsxs)(n.p,{children:["To ensure that your node is properly connected as a validator on the network,\ninvoke the following command on your ",(0,s.jsx)(n.code,{children:"server"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"oasis-node control status -a unix:/node/data/internal.sock | jq .consensus.is_validator\n"})}),"\n",(0,s.jsx)(n.p,{children:"If your node is registered and became a validator, the above command should\noutput:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"true\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Nodes are only elected into the validator set at epoch transitions, so you may\nneed to wait for up to an epoch before being considered."})}),"\n",(0,s.jsx)(n.admonition,{type:"caution",children:(0,s.jsxs)(n.p,{children:["In order to be elected in the validator set you ",(0,s.jsx)(n.strong,{children:"need to have enough\nstake to be in the top K entities"})," (where K is a network-specific parameter\nspecified by the ",(0,s.jsx)(n.a,{href:"/node/reference/genesis-doc#consensus",children:(0,s.jsx)(n.code,{children:"scheduler.max_validators"})})," field in the genesis document)."]})}),"\n",(0,s.jsx)(n.p,{children:"Congratulations, if you made it this far, you've properly connected your node\nto the network and became a validator on the Oasis Network."}),"\n",(0,s.jsx)(n.h2,{id:"oasis-metadata-registry",children:"Oasis Metadata Registry"}),"\n",(0,s.jsxs)(n.p,{children:["For the final touch, you can add some metadata about your entity to the\n",(0,s.jsx)(n.a,{href:"https://github.com/oasisprotocol/metadata-registry",children:"Metadata Registry"}),". The Metadata Registry is the same for Mainnet and\nthe Testnet. The metadata consists of your entity name, email, Keybase handle,\nTwitter handle, etc. This information is also used by various applications.\nFor example the ",(0,s.jsx)(n.a,{href:"https://wallet.oasis.io",children:"ROSE Wallet - Web"})," and the ",(0,s.jsx)(n.a,{href:"https://www.oasisscan.com/validators",children:"Oasis Scan"})," will fetch and show\nthe node operator's name and the avatar."]}),"\n",(0,s.jsx)(n.h1,{id:"see-also",children:"See also"}),"\n",(0,s.jsx)(r.A,{items:[(0,a.$)("/build/tools/cli/"),(0,a.$)("/core/oasis-node/cli"),(0,a.$)("/node/grpc")]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);