"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[2661],{28453:(e,t,i)=>{i.d(t,{R:()=>r,x:()=>l});var n=i(96540);const s={},o=n.createContext(s);function r(e){const t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(o.Provider,{value:t},e.children)}},93844:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>a,contentTitle:()=>l,default:()=>c,frontMatter:()=>r,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"build/tools/build-paratime/modules","title":"Modules","description":"As we saw in the [minimal runtime example], creating an Oasis runtime is very","source":"@site/docs/build/tools/build-paratime/modules.md","sourceDirName":"build/tools/build-paratime","slug":"/build/tools/build-paratime/modules","permalink":"/build/tools/build-paratime/modules","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/oasis-sdk/edit/main/docs/runtime/modules.md","tags":[],"version":"current","lastUpdatedAt":1761867754000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"developers","previous":{"title":"Minimal Runtime","permalink":"/build/tools/build-paratime/minimal-runtime"},"next":{"title":"Reproducibility","permalink":"/build/tools/build-paratime/reproducibility"}}');var s=i(74848),o=i(28453);const r={sidebar_custom_props:{tags:void 0}},l="Modules",a={},d=[{value:"Runtime Trait",id:"runtime-trait",level:2},{value:"Version",id:"version",level:3},{value:"List of Modules",id:"list-of-modules",level:3},{value:"Genesis State",id:"genesis-state",level:3},{value:"Module Lifecycle Traits",id:"module-lifecycle-traits",level:2},{value:"Context",id:"context",level:2},{value:"Putting It All Together",id:"putting-it-all-together",level:2}];function u(e){const t={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"modules",children:"Modules"})}),"\n",(0,s.jsxs)(t.p,{children:["As we saw in the ",(0,s.jsx)(t.a,{href:"/build/tools/build-paratime/minimal-runtime",children:"minimal runtime example"}),", creating an Oasis runtime is very\neasy to do thanks to the boilerplate provided by the Oasis SDK. The example\nhinted that almost all of the implementation of the state transition function\nis actually hidden inside the ",(0,s.jsx)(t.em,{children:"modules"})," that are composed together to form a\nruntime."]}),"\n",(0,s.jsx)(t.p,{children:"This chapter explores how modules are built."}),"\n",(0,s.jsx)(t.h2,{id:"runtime-trait",children:"Runtime Trait"}),"\n",(0,s.jsxs)(t.p,{children:["Let's briefly revisit the ",(0,s.jsx)(t.code,{children:"Runtime"})," trait which is what brings everything\ntogether. As we saw when ",(0,s.jsx)(t.a,{href:"/build/tools/build-paratime/minimal-runtime#runtime-definition",children:"defining the minimal runtime"}),", the trait requires\nimplementing some basic things:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-rust",children:"impl sdk::Runtime for Runtime {\n    // Use the crate version from Cargo.toml as the runtime version.\n    const VERSION: Version = sdk::version_from_cargo!();\n\n    // Module that provides the core API.\n    type Core = modules::core::Module;\n    // Module that provides the accounts API.\n    type Accounts = modules::accounts::Module;\n\n    // Define the modules that the runtime will be composed of.\n    type Modules = (modules::core::Module, modules::accounts::Module);\n\n    // Define the genesis (initial) state for all of the specified modules. This\n    // state is used when the runtime is first initialized.\n    //\n    // The return value is a tuple of states in the same order as the modules\n    // are defined above.\n    fn genesis_state() -> <Self::Modules as sdk::module::MigrationHandler>::Genesis {\n        (\n            // Core module.\n            modules::core::Genesis {\n                // ... snip ...\n            },\n            // Accounts module.\n            modules::accounts::Genesis {\n                // ... snip ...\n            },\n        )\n    }\n}\n"})}),"\n",(0,s.jsx)(t.h3,{id:"version",children:"Version"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"VERSION"})," constant is pretty self-explanatory as it makes it possible to\nversion runtimes and check compatibility with other nodes. The versioning scheme\nfollows ",(0,s.jsx)(t.a,{href:"https://semver.org/",children:"semantic versioning"})," with the following semantics:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"major"})," version is used when determining state transition function\ncompatibility. If any introduced change could lead to a discrepancy when\nrunning alongside a previous version, the major version ",(0,s.jsx)(t.em,{children:"must"})," be bumped."]}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.a,{href:"/core/consensus/services/scheduler",children:"Oasis Core scheduler service"})," will make sure to only schedule nodes which\nare running a compatible version in order to make upgrades easier."]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"minor"})," and ",(0,s.jsx)(t.strong,{children:"patch"})," versions are ignored when determining\ncompatibility and can be used for non-breaking features or fixes."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"list-of-modules",children:"List of Modules"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"Modules"})," associated type contains all of the module types that compose the\nruntime. Due to the way modules are defined, you can specify multiple modules\nby using a tuple."]}),"\n",(0,s.jsx)(t.h3,{id:"genesis-state",children:"Genesis State"}),"\n",(0,s.jsx)(t.p,{children:"The genesis state is the initial state of the runtime. It is used when the\nruntime is first deployed to populate the initial persistent state of all of the\nmodules."}),"\n",(0,s.jsx)(t.p,{children:"Each module can define its own genesis state format together with the methods\nfor transforming that genesis state into internal persistent state."}),"\n",(0,s.jsx)(t.h2,{id:"module-lifecycle-traits",children:"Module Lifecycle Traits"}),"\n",(0,s.jsx)(t.h2,{id:"context",children:"Context"}),"\n",(0,s.jsx)(t.h2,{id:"putting-it-all-together",children:"Putting It All Together"})]})}function c(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}}}]);