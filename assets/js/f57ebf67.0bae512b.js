"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[7793],{28453:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>d});var r=o(96540);const i={},t=r.createContext(i);function s(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(t.Provider,{value:n},e.children)}},81890:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"node/run-your-node/troubleshooting","title":"Troubleshooting","description":"Oasis Node Troubleshooting for Node Operators and Hackers","source":"@site/docs/node/run-your-node/troubleshooting.md","sourceDirName":"node/run-your-node","slug":"/node/run-your-node/troubleshooting","permalink":"/node/run-your-node/troubleshooting","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/docs/edit/main/docs/node/run-your-node/troubleshooting.md","tags":[],"version":"current","lastUpdatedAt":1761867754000,"frontMatter":{"description":"Oasis Node Troubleshooting for Node Operators and Hackers","sidebar_custom_props":{}},"sidebar":"operators","previous":{"title":"Remote Signer for Oasis Node Keys","permalink":"/node/run-your-node/advanced/remote-signer"},"next":{"title":"Web3 Gateway","permalink":"/node/web3"}}');var i=o(74848),t=o(28453);const s={description:"Oasis Node Troubleshooting for Node Operators and Hackers",sidebar_custom_props:{tags:void 0}},d="Troubleshooting",l={},a=[{value:"Starting a Node",id:"starting-a-node",level:2},{value:"Invalid Permissions",id:"invalid-permissions",level:3},{value:"Permissions for node and entity",id:"permissions-for-node-and-entity",level:4},{value:"Permissions for .pem files",id:"permissions-for-pem-files",level:4},{value:"Node directory Ownership",id:"node-directory-ownership",level:4},{value:"Cannot Find File",id:"cannot-find-file",level:3},{value:"Staking and Registering",id:"staking-and-registering",level:2},{value:"Transaction Out of Gas",id:"transaction-out-of-gas",level:3},{value:"Trusted Execution Environment (TEE)",id:"tee",level:2},{value:"AESM could not be contacted",id:"aesm-could-not-be-contacted",level:3},{value:"AESM: error 30",id:"aesm-error-30",level:3},{value:"Permission Denied When Accessing SGX Kernel Device",id:"permission-denied-when-accessing-sgx-kernel-device",level:3},{value:"Error Opening SGX Kernel Device",id:"error-opening-sgx-kernel-device",level:3},{value:"Ensure <code>/dev</code> is NOT Mounted with the <code>noexec</code> Option",id:"ensure-dev-is-not-mounted-with-the-noexec-option",level:4},{value:"Unable to Launch Enclaves: Operation not permitted",id:"unable-to-launch-enclaves-operation-not-permitted",level:3},{value:"Unable to Launch Enclaves: Invalid argument",id:"unable-to-launch-enclaves-invalid-argument",level:3},{value:"Unable to Launch Enclaves: Input/output error",id:"unable-to-launch-enclaves-inputoutput-error",level:3},{value:"Couldn&#39;t find the platform library",id:"couldnt-find-the-platform-library",level:3},{value:"[QPL] Failed to get quote config. Error code is 0xb011",id:"qpl-failed-to-get-quote-config-error-code-is-0xb011",level:3},{value:"[QPL] No certificate data for this platform.",id:"qpl-no-certificate-data-for-this-platform",level:3},{value:"ROFL",id:"rofl",level:2},{value:"Unknown enclave",id:"unknown-enclave",level:3},{value:"Root not found",id:"root-not-found",level:3},{value:"Failed to resize persistent overlay image",id:"failed-to-resize-persistent-overlay-image",level:3},{value:"Offer not acceptable for this instance",id:"offer-not-acceptable-for-this-instance",level:3},{value:"Image platform (linux/arm64/v8) does not match the expected platform (linux/amd64)",id:"image-platform-linuxarm64v8-does-not-match-the-expected-platform-linuxamd64",level:3}];function c(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",mdxAdmonitionTitle:"mdxAdmonitionTitle",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"troubleshooting",children:"Troubleshooting"})}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsx)(n.mdxAdmonitionTitle,{children:(0,i.jsx)(n.strong,{children:"BEFORE YOU BEGIN TROUBLESHOOTING"})}),(0,i.jsx)(n.p,{children:"Before you begin troubleshooting your Oasis Node we suggest you check all of the\nfollowing:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Check that your current binary version matches the version listed on the Network Parameters page (",(0,i.jsx)(n.a,{href:"/node/network/mainnet",children:"Mainnet"}),", ",(0,i.jsx)(n.a,{href:"/node/network/testnet",children:"Testnet"}),")"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Check the version on your localhost using ",(0,i.jsx)(n.code,{children:"oasis-node --version"})]}),"\n",(0,i.jsxs)(n.li,{children:["Check the version on your server using ",(0,i.jsx)(n.code,{children:"oasis-node --version"})]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If upgrading, make sure that you've wiped state (unless that is explicitly not required)"}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If you're doing anything with the entity:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Do you have the latest genesis?"}),"\n",(0,i.jsx)(n.li,{children:"Do you have the correct private key (or Ledger device)."}),"\n",(0,i.jsxs)(n.li,{children:["If you're signing a transaction:","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Check your account balance and nonce using the ",(0,i.jsx)(n.a,{href:"/build/tools/cli/account#show",children:(0,i.jsx)(n.code,{children:"oasis account show"})})," command."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If you're generating a transaction:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Do you have the latest genesis?"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"If you're submitting a transaction:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Do you have the latest genesis?"}),"\n",(0,i.jsx)(n.li,{children:"Is your node synced? If not, the transaction will fail to run properly"}),"\n"]}),"\n"]}),"\n"]})]}),"\n",(0,i.jsx)(n.h2,{id:"starting-a-node",children:"Starting a Node"}),"\n",(0,i.jsx)(n.h3,{id:"invalid-permissions",children:"Invalid Permissions"}),"\n",(0,i.jsx)(n.h4,{id:"permissions-for-node-and-entity",children:"Permissions for node and entity"}),"\n",(0,i.jsx)(n.p,{children:"Error Message:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"common/Mkdir: path '/node/data' has invalid permissions: -rwxr-xr-x\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"entity"})," and ",(0,i.jsx)(n.code,{children:"node"})," directories both need to have permissions ",(0,i.jsx)(n.code,{children:"rwx------"}),". Make sure you initialize the directory with correct permissions or change them using ",(0,i.jsx)(n.code,{children:"chmod"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"mkdir --mode 700 --parents {entity,node}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"chmod 700 /node/data\nchmod 700 /node/etc\n"})}),"\n",(0,i.jsx)(n.h4,{id:"permissions-for-pem-files",children:"Permissions for .pem files"}),"\n",(0,i.jsx)(n.p,{children:"Error Message example:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"signature/signer/file: invalid PEM file permissions 700 on /node/data/identity.pem\n"})}),"\n",(0,i.jsxs)(n.p,{children:["All ",(0,i.jsx)(n.code,{children:".pem"})," files should have the permissions ",(0,i.jsx)(n.code,{children:"600"}),". You can set the permissions for all ",(0,i.jsx)(n.code,{children:".pem"})," files in a directory using the following command:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"chmod -R 600 /path/*.pem\n"})}),"\n",(0,i.jsx)(n.h4,{id:"node-directory-ownership",children:"Node directory Ownership"}),"\n",(0,i.jsxs)(n.p,{children:["Another possible cause of permission issues is not giving ownership of your ",(0,i.jsx)(n.code,{children:"node/"})," to the user running the node (e.g. ",(0,i.jsx)(n.code,{children:"docker-host"})," or replace with your user):"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"chown -R docker-host:docker-host /node\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In general, to avoid problems when running docker, specify the user when running ",(0,i.jsx)(n.code,{children:"docker"})," commands by adding the flag ",(0,i.jsx)(n.code,{children:"--user $(id -u):$(id -g)"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"cannot-find-file",children:"Cannot Find File"}),"\n",(0,i.jsx)(n.p,{children:"Error Message examples:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"no such file or directory\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"file does not exist\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "ts":"2019-11-17T03:42:09.778647033Z",\n  "level":"error",\n  "module":"cmd/registry/node",\n  "caller":"node.go:127",\n  "msg":"failed to load entity",\n  "err":"file does not exist"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["More often than you'd expect, this error is the result of setting the path incorrectly. You may have left something like ",(0,i.jsx)(n.code,{children:"--genesis.file $GENESIS_FILE_PATH"})," in the command without setting ",(0,i.jsx)(n.code,{children:"$GENESIS_FILE_PATH"})," first, or set the path incorrectly. Check that ",(0,i.jsx)(n.code,{children:"echo $GENESIS_FILE_PATH"})," matches your expectation or provide a path in the command."]}),"\n",(0,i.jsx)(n.p,{children:"Another possible cause: the files in your localhost directory cannot be read from the container. Make sure to run commands in the same session within the container."}),"\n",(0,i.jsx)(n.h2,{id:"staking-and-registering",children:"Staking and Registering"}),"\n",(0,i.jsx)(n.h3,{id:"transaction-out-of-gas",children:"Transaction Out of Gas"}),"\n",(0,i.jsx)(n.p,{children:"Error message:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'module=cmd/stake caller=stake.go:70 msg="failed to submit transaction" err="rpc error: code = Unknown desc = staking: add escrow transaction failed: out of gas" attempt=1\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The docs are now updated to show that you need to add ",(0,i.jsx)(n.code,{children:"--stake.transaction.fee.gas"})," and ",(0,i.jsx)(n.code,{children:"--stake.transaction.fee.amount"})," flags when generating your transaction. Note that if you're re-generating a transaction, you will need to increment the ",(0,i.jsx)(n.code,{children:"--nonce"})," flag."]}),"\n",(0,i.jsx)(n.h2,{id:"tee",children:"Trusted Execution Environment (TEE)"}),"\n",(0,i.jsx)(n.h3,{id:"aesm-could-not-be-contacted",children:"AESM could not be contacted"}),"\n",(0,i.jsxs)(n.p,{children:["If running ",(0,i.jsx)(n.code,{children:"sgx-detect --verbose"})," reports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\ud83d\udd6e  SGX system software > AESM service\nAESM could not be contacted. AESM is needed for launching enclaves and generating attestations.\n\nPlease check your AESM installation.\n\ndebug: error communicating with aesm\ndebug: cause: Connection refused (os error 111)\n\nMore information: https://edp.fortanix.com/docs/installation/help/#aesm-service\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Ensure  you have completed all the necessary installation steps outlined in\n",(0,i.jsx)(n.a,{href:"/node/run-your-node/prerequisites/set-up-tee#dcap-attestation",children:"DCAP Attestation"})," section."]}),"\n",(0,i.jsx)(n.h3,{id:"aesm-error-30",children:"AESM: error 30"}),"\n",(0,i.jsx)(n.p,{children:"If you are encountering the following error message in your node's logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"failed to initialize TEE: error while getting quote info from AESMD: aesm: error 30\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Ensure you have all required SGX driver libraries installed as listed in\n",(0,i.jsx)(n.a,{href:"/node/run-your-node/prerequisites/set-up-tee#dcap-attestation",children:"DCAP Attestation"})," section."]}),"\n",(0,i.jsx)(n.h3,{id:"permission-denied-when-accessing-sgx-kernel-device",children:"Permission Denied When Accessing SGX Kernel Device"}),"\n",(0,i.jsxs)(n.p,{children:["If running ",(0,i.jsx)(n.code,{children:"sgx-detect --verbose"})," reports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\ud83d\udd6e  SGX system software > SGX kernel device\nPermission denied while opening the SGX device (/dev/sgx/enclave, /dev/sgx or\n/dev/isgx). Make sure you have the necessary permissions to create SGX enclaves.\nIf you are running in a container, make sure the device permissions are\ncorrectly set on the container.\n\ndebug: Error opening device: Permission denied (os error 13)\ndebug: cause: Permission denied (os error 13)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Ensure you are running the ",(0,i.jsx)(n.code,{children:"sgx-detect"})," tool as ",(0,i.jsx)(n.code,{children:"root"})," via:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo $(which sgx-detect) --verbose\n"})}),"\n",(0,i.jsx)(n.h3,{id:"error-opening-sgx-kernel-device",children:"Error Opening SGX Kernel Device"}),"\n",(0,i.jsxs)(n.p,{children:["If running ",(0,i.jsx)(n.code,{children:"sgx-detect --verbose"})," reports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'\ud83d\udd6e  SGX system software > SGX kernel device\nThe SGX device (/dev/sgx/enclave, /dev/sgx or /dev/isgx) could not be opened:\n"/dev" mounted with `noexec` option.\n\ndebug: Error opening device: "/dev" mounted with `noexec` option\ndebug: cause: "/dev" mounted with `noexec` option\n'})}),"\n",(0,i.jsxs)(n.h4,{id:"ensure-dev-is-not-mounted-with-the-noexec-option",children:["Ensure ",(0,i.jsx)(n.code,{children:"/dev"})," is NOT Mounted with the ",(0,i.jsx)(n.code,{children:"noexec"})," Option"]}),"\n",(0,i.jsxs)(n.p,{children:["Some Linux distributions mount ",(0,i.jsx)(n.code,{children:"/dev"})," with the ",(0,i.jsx)(n.code,{children:"noexec"})," mount option. If that is\nthe case, it will prevent the enclave loader from mapping executable pages."]}),"\n",(0,i.jsxs)(n.p,{children:["Ensure your ",(0,i.jsx)(n.code,{children:"/dev"})," (i.e. ",(0,i.jsx)(n.code,{children:"devtmpfs"}),") is not mounted with the ",(0,i.jsx)(n.code,{children:"noexec"})," option.\nTo check that, use:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"cat /proc/mounts | grep devtmpfs\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To temporarily remove the ",(0,i.jsx)(n.code,{children:"noexec"})," mount option for ",(0,i.jsx)(n.code,{children:"/dev"}),", run:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo mount -o remount,exec /dev\n"})}),"\n",(0,i.jsxs)(n.p,{children:["To permanently remove the ",(0,i.jsx)(n.code,{children:"noexec"})," mount option for ",(0,i.jsx)(n.code,{children:"/dev"}),", add the following to\nthe system's ",(0,i.jsx)(n.code,{children:"/etc/fstab"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"devtmpfs        /dev        devtmpfs    defaults,exec 0 0\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["This is the recommended way to modify mount options for virtual (i.e. API) file\nsystem as described in ",(0,i.jsx)(n.a,{href:"https://www.freedesktop.org/wiki/Software/systemd/APIFileSystems/",children:"systemd's API File Systems"}),"\ndocumentation."]})}),"\n",(0,i.jsx)(n.h3,{id:"unable-to-launch-enclaves-operation-not-permitted",children:"Unable to Launch Enclaves: Operation not permitted"}),"\n",(0,i.jsxs)(n.p,{children:["If running ",(0,i.jsx)(n.code,{children:"sgx-detect --verbose"})," reports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\ud83d\udd6e  SGX system software > Able to launch enclaves > Debug mode\nThe enclave could not be launched.\n\ndebug: failed to load report enclave\ndebug: cause: failed to load report enclave\ndebug: cause: Failed to map enclave into memory.\ndebug: cause: Operation not permitted (os error 1)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Ensure your system's ",(0,i.jsxs)(n.a,{href:"#ensure-dev-is-not-mounted-with-the-noexec-option",children:[(0,i.jsx)(n.code,{children:"/dev"})," is NOT mounted with the ",(0,i.jsx)(n.code,{children:"noexec"})," mount option"]}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"unable-to-launch-enclaves-invalid-argument",children:"Unable to Launch Enclaves: Invalid argument"}),"\n",(0,i.jsxs)(n.p,{children:["If running ",(0,i.jsx)(n.code,{children:"sgx-detect --verbose"})," reports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\ud83d\udd6e  SGX system software > Able to launch enclaves > Debug mode\nThe enclave could not be launched.\n\ndebug: failed to load report enclave\ndebug: cause: Failed to call EINIT.\ndebug: cause: I/O ctl failed.\ndebug: cause: Invalid argument (os error 22)\n"})}),"\n",(0,i.jsx)(n.p,{children:"This may be related to a bug in the Linux kernel when attempting to run enclaves\non certain hardware configurations. Upgrading the Linux kernel to a version\nequal to or greater than 6.5.0 may solve the issue."}),"\n",(0,i.jsx)(n.h3,{id:"unable-to-launch-enclaves-inputoutput-error",children:"Unable to Launch Enclaves: Input/output error"}),"\n",(0,i.jsxs)(n.p,{children:["If running ",(0,i.jsx)(n.code,{children:"sgx-detect --verbose"})," reports:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\ud83d\udd6e SGX system software > Able to launch enclaves > Debug mode\nThe enclave could not be launched.\n\ndebug: failed to load report enclave\ndebug: cause: Failed to call ECREATE.\ndebug: cause: I/O ctl failed.\ndebug: cause: Input/output error (os error 5)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This may be related to a bug in the ",(0,i.jsx)(n.a,{href:"https://github.com/fortanix/rust-sgx/issues/565",children:(0,i.jsx)(n.code,{children:"rust-sgx"})}),"\nlibrary causing ",(0,i.jsx)(n.code,{children:"sgx-detect"})," (and ",(0,i.jsx)(n.code,{children:"attestation-tool"}),") to fail and report that\ndebug enclaves cannot be launched. This is a known issue and is being worked on.\nIf the ",(0,i.jsx)(n.code,{children:"sgx-detect"})," is reporting that production enclaves can be launched, you\ncan ignore this error when setting up the Oasis node."]}),"\n",(0,i.jsx)(n.h3,{id:"couldnt-find-the-platform-library",children:"Couldn't find the platform library"}),"\n",(0,i.jsx)(n.p,{children:"If AESMD service log reports:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"[read_persistent_data ../qe_logic.cpp:1084] Couldn't find the platform library. (null)\n[get_platform_quote_cert_data ../qe_logic.cpp:438] Couldn't load the platform library. (null)\n"})}),"\n",(0,i.jsxs)(n.p,{children:["It may be that the ",(0,i.jsx)(n.a,{href:"/node/run-your-node/prerequisites/set-up-tee#configuring-the-quote-provider",children:"DCAP quote provider"})," is\nmisconfigured or the configuration file is not a valid JSON file but is\nmalformed. Double-check that its configuration file (e.g.\n",(0,i.jsx)(n.code,{children:"/etc/sgx_default_qcnl.conf"}),") is correct."]}),"\n",(0,i.jsx)(n.h3,{id:"qpl-failed-to-get-quote-config-error-code-is-0xb011",children:"[QPL] Failed to get quote config. Error code is 0xb011"}),"\n",(0,i.jsx)(n.p,{children:"The following error appears in the QGS daemon logs leaving ROFL runtime\ninoperable:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"qgsd[1412990]: [QPL] Failed to get quote config. Error code is 0xb011\nqgsd[1412990]: [get_platform_quote_cert_data ../td_ql_logic.cpp:302] Error returned from the p_sgx_get_quote_config API. 0xe044\nqgsd[1412990]: tee_att_get_quote_size return 0x11001\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This is a known bug, which hasn't been fixed yet at time of writing this section\n",(0,i.jsx)(n.a,{href:"https://github.com/intel/SGXDataCenterAttestationPrimitives/issues/450",children:"https://github.com/intel/SGXDataCenterAttestationPrimitives/issues/450"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["The current workaround is to restart the QGS daemon, for example\n",(0,i.jsx)(n.code,{children:"sudo service qgsd restart"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"If you are managing your QGS daemon with Docker compose, you can configure it as\nfollows:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="docker-compose.yaml"',children:'  command: ["/opt/intel/tdx-qgs/qgs", "--no-daemon"]\n  entrypoint: ["/bin/bash", "-c", "exec \\"$0\\" \\"$@\\" &> >(tee -a /tmp/qgsd.log)"]\n  init: true\n  healthcheck:\n    test: ["CMD", "/bin/bash", "-c", "grep \'Error code is 0xb011\' /tmp/qgsd.log && (: > /tmp/qgsd.log && kill -SIGTERM 1 && exit -1) || (: > /tmp/qgsd.log && exit 0)"]\n    interval: 60s\n    timeout: 2s\n    retries: 0\n'})}),"\n",(0,i.jsx)(n.h3,{id:"qpl-no-certificate-data-for-this-platform",children:"[QPL] No certificate data for this platform."}),"\n",(0,i.jsx)(n.p,{children:"The following error is reported on a multi-CPU systems if the user forgot to\ninstall and configure MPA:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"May 09 13:24:16 oasis-node-1 qgsd[6732]: call tee_att_init_quote\nMay 09 13:24:16 oasis-node-1 qgsd[6732]: [QPL] No certificate data for this platform.\nMay 09 13:24:16 oasis-node-1 qgsd[6732]: [get_platform_quote_cert_data ../td_ql_logic.cpp:302] Error returned from the p_sgx_get_quote_config API. 0xe011\nMay 09 13:24:16 oasis-node-1 qgsd[6732]: tee_att_init_quote return 0x11001\nMay 09 13:24:16 oasis-node-1 qgsd[6732]: tee_att_get_quote_size return 0x1100f\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Correctly configure your TEE by following the ",(0,i.jsx)(n.a,{href:"/node/run-your-node/prerequisites/set-up-tee#multi-socket-systems",children:"Set up TEE - Multi-socket\nsystem"})," section."]}),"\n",(0,i.jsx)(n.h2,{id:"rofl",children:"ROFL"}),"\n",(0,i.jsx)(n.p,{children:"The following errors appear in the ROFL node logs."}),"\n",(0,i.jsx)(n.h3,{id:"unknown-enclave",children:"Unknown enclave"}),"\n",(0,i.jsx)(n.p,{children:"This error is reported when the enclave ID of the ROFL provided in the .orc file\nmismatches the currently registered enclave ID of the on-chain ROFL app."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "component":"rofl.rofl1qrtetspnld9efpeasxmryl6nw9mgllr0euls3dwn",\n  "err":"call failed: module=rofl code=5: unknown enclave",\n  "level":"error",\n  "module":"runtime/modules/rofl/app/registration",\n  "msg":"failed to refresh registration",\n  "provisioner":"tdx-qemu",\n  "runtime_id":"000000000000000000000000000000000000000000000000a6d1e3ebf60dff6c",\n  "runtime_name":"",\n  "ts":"2025-02-21T08:10:10.012956311Z"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Update the on-chain enclave ID by running ",(0,i.jsx)(n.code,{children:"oasis rofl update"})," on the machine\nwhere ROFL is being compiled and deployed."]}),"\n",(0,i.jsx)(n.h3,{id:"root-not-found",children:"Root not found"}),"\n",(0,i.jsx)(n.p,{children:"This error is reported, when the node hasn't been fully synced yet. This\nincludes both the consensus and the ParaTime blocks."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "component":"rofl.rofl1qrtetspnld9efpeasxmryl6nw9mgllr0euls3dwn",\n  "err":"call failed: root not found",\n  "level":"error",\n  "module":"runtime/modules/rofl/app/registration",\n  "msg":"failed to refresh registration",\n  "provisioner":"tdx-qemu",\n  "runtime_id":"000000000000000000000000000000000000000000000000a6d1e3ebf60dff6c",\n  "runtime_name":"",\n  "ts":"2025-04-17T05:40:24.305875715Z"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Wait for the node to sync."}),"\n",(0,i.jsx)(n.h3,{id:"failed-to-resize-persistent-overlay-image",children:"Failed to resize persistent overlay image"}),"\n",(0,i.jsxs)(n.p,{children:["The following error is reported on the ROFL node, if there was an error during\nthe persistent storage resize operation. Most commonly this happens during ROFL\nupgrade if ",(0,i.jsx)(n.a,{href:"/build/rofl/features/manifest#resources-storage",children:"persistent storage size"})," was decreased below the\nactually occupied storage."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "caller":"host.go:486",\n  "err":"failed to configure process: failed to resize persistent overlay image: qemu-img: Use the --shrink option to perform a shrink operation.\\nqemu-img: warning: Shrinking an image will delete all data beyond the shrunken image\'s end. Before performing such an operation, make sure there is no important data there.\\n\\nexit status 1",\n  "level":"error",\n  "module":"runtime/host/tdx/qemu",\n  "msg":"failed to start runtime",\n  "runtime_id":"000000000000000000000000000000000000000000000000a6d1e3ebf60dff6c",\n  "ts":"2025-04-17T09:56:36.321911319Z"\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Similarly, if the persistent storage is corrupted in any way, a message like\nthis may appear in the logs:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "component":"rofl.rofl1qrtetspnld9efpeasxmryl6nw9mgllr0euls3dwn",\n  "level":"info",\n  "module":"runtime/global",\n  "msg":"Error: writing blob: adding layer with blob \\"sha256:9f202d637e1bbe0e48c7855d7872fa4ab33af88b61ef10d4cb6dd7caba0e2c8a\\"/\\"\\"/\\"sha256:b240b4f256e7bd304b5a1335b4bc73b47ce21aaf31bb1107452a89a101f50054\\": readlink /storage/containers/graph/overlay/l: invalid argument",\n  "provisioner":"tdx-qemu",\n  "runtime_id":"000000000000000000000000000000000000000000000000a6d1e3ebf60dff6c",\n  "runtime_name":"",\n  "ts":"2025-02-25T13:44:47.05176383Z"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["ROFL admin user should run ",(0,i.jsx)(n.code,{children:"oasis rofl machine restart --wipe-storage"})," to clear\npersistent storage and recreate the volume of the ROFL app."]}),"\n",(0,i.jsxs)(n.p,{children:["Alternatively, you can remove the persistent storage folder manually located at\n",(0,i.jsx)(n.code,{children:"/node/data/runtimes/volumes/<rofl_app_volume_id>"})," and restart the ROFL app."]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsx)(n.p,{children:"Both options will permanently delete persistent storage of this ROFL app on the\nROFL node."})}),"\n",(0,i.jsx)(n.h3,{id:"offer-not-acceptable-for-this-instance",children:"Offer not acceptable for this instance"}),"\n",(0,i.jsx)(n.p,{children:"The following error occurs, if your ROFL node Scheduler configuration is not\nconfigured to accept the offer names of the selected provider."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "component":"rofl.rofl1qrqw99h0f7az3hwt2cl7yeew3wtz0fxunu7luyfg",\n  "id":"0000000000000005",\n  "level":"info",\n  "module":"runtime/scheduler/manager",\n  "msg":"offer not acceptable for this instance",\n  "offer":"0000000000000002",\n  "provisioner":"tdx-qemu",\n  "runtime_id":"000000000000000000000000000000000000000000000000a6d1e3ebf60dff6c",\n  "runtime_name":"",\n  "ts":"2025-04-25T09:25:57.726444176Z"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Update your node's ",(0,i.jsx)(n.code,{children:"runtime.runtimes.sapphire_id.components.scheduler_id.config.rofl_scheduler.offers"}),"\nin your ",(0,i.jsx)(n.code,{children:"config.yml"})," and include the valid offer name."]}),"\n",(0,i.jsx)(n.h3,{id:"image-platform-linuxarm64v8-does-not-match-the-expected-platform-linuxamd64",children:"Image platform (linux/arm64/v8) does not match the expected platform (linux/amd64)"}),"\n",(0,i.jsxs)(n.p,{children:["This error occurs, if the Docker container to be executed inside the ROFL TDX\nwas not compiled for the ",(0,i.jsx)(n.code,{children:"linux/amd64"})," platform."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "component":"rofl.rofl1qpdzzm4h73gtes04xjn4whan84s3k33l5gx787l2",\n  "level":"info",\n  "module":"runtime/global",\n  "msg":"WARNING: image platform (linux/arm64/v8) does not match the expected platform (linux/amd64)",\n  "provisioner":"tdx-qemu",\n  "runtime_id":"000000000000000000000000000000000000000000000000f80306c9858e7279",\n  "runtime_name":"",\n  "ts":"2025-04-28T06:16:24.20330395Z"\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Always compile your Docker container for ROFL with the ",(0,i.jsx)(n.code,{children:"--platform linux/amd64"}),"\nparameter or put the ",(0,i.jsx)(n.code,{children:"platform: linux/amd64"})," line inside your ",(0,i.jsx)(n.code,{children:"compose.yaml"}),".\nThen recompile and push the container to the OCI repository."]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);