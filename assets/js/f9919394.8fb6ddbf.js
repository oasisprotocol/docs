"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[3261],{28453:(n,e,t)=>{t.d(e,{R:()=>o,x:()=>r});var s=t(96540);const a={},i=s.createContext(a);function o(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function r(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(a):n.components||a:o(n.components),s.createElement(i.Provider,{value:e},n.children)}},81052:(n,e,t)=>{t.r(e),t.d(e,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"build/tools/cli/transaction","title":"Transaction","description":"Use CLI to decode, verify, sign and submit a transaction","source":"@site/docs/build/tools/cli/transaction.md","sourceDirName":"build/tools/cli","slug":"/build/tools/cli/transaction","permalink":"/build/tools/cli/transaction","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/cli/edit/master/docs/transaction.md","tags":[],"version":"current","lastUpdatedAt":1758873168000,"frontMatter":{"title":"Transaction","description":"Use CLI to decode, verify, sign and submit a transaction","sidebar_custom_props":{}},"sidebar":"developers","previous":{"title":"Account","permalink":"/build/tools/cli/account"},"next":{"title":"Address book","permalink":"/build/tools/cli/addressbook"}}');var a=t(74848),i=t(28453);const o={title:"Transaction",description:"Use CLI to decode, verify, sign and submit a transaction",sidebar_custom_props:{tags:void 0}},r="Transaction Tools",c={},d=[{value:"Decode, Verify and Show a Transaction",id:"show",level:2},{value:"Sign a Transaction",id:"sign",level:2},{value:"Submit a Transaction",id:"submit",level:2}];function l(n){const e={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...n.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"transaction-tools",children:"Transaction Tools"})}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"transaction"})," command offers convenient tools for processing raw\nconsensus or ParaTime transactions stored in a JSON file:"]}),"\n",(0,a.jsxs)(e.ul,{children:["\n",(0,a.jsx)(e.li,{children:"decoding and displaying the transaction,"}),"\n",(0,a.jsx)(e.li,{children:"verifying transaction's signature,"}),"\n",(0,a.jsx)(e.li,{children:"signing the transaction,"}),"\n",(0,a.jsx)(e.li,{children:"broadcasting the transaction."}),"\n"]}),"\n",(0,a.jsx)(e.h2,{id:"show",children:"Decode, Verify and Show a Transaction"}),"\n",(0,a.jsxs)(e.p,{children:["To show the transaction, invoke ",(0,a.jsx)(e.code,{children:"transaction show <filename.json>"})," and provide\na filename containing a previously generated transaction by ",(0,a.jsx)(e.code,{children:"oasis-node"})," or the\nOasis CLI's ",(0,a.jsx)(e.a,{href:"/build/tools/cli/account#output-file",children:(0,a.jsx)(e.code,{children:"--output-file"})})," parameter."]}),"\n",(0,a.jsxs)(e.p,{children:["For example, let's take the following transaction transferring ",(0,a.jsx)(e.code,{children:"1.0 TEST"})," from\n",(0,a.jsx)(e.code,{children:"test:alice"})," to ",(0,a.jsx)(e.code,{children:"test:bob"})," on Testnet consensus layer and store it to\n",(0,a.jsx)(e.code,{children:"testtx.json"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",metastring:'title="testtx.json"',children:'{\n  "untrusted_raw_value": "pGNmZWWiY2dhcwFmYW1vdW50QGRib2R5omJ0b1UAyND0Wds45cwxynfmbSxEVty+tQJmYW1vdW50RDuaygBlbm9uY2UBZm1ldGhvZHBzdGFraW5nLlRyYW5zZmVy",\n  "signature": {\n    "public_key": "NcPzNW3YU2T+ugNUtUWtoQnRvbOL9dYSaBfbjHLP1pE=",\n    "signature": "ph5Sj29JFG8p0rCqAXjHm+yLwiXHybxah9C1cVTI01SDeJlyXT8dbp4BfI1hFxBomgi1hOrevTpShX0f9puTCQ=="\n  }\n}\n'})}),"\n",(0,a.jsx)(e.p,{children:"We can decode and verify the transaction as follows:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis transaction show testtx.json --network testnet\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Hash: c996e9d17d652d5dc64589d10806c244a5ef0f650cc2ec8c810b28a85fef5705\nSigner: NcPzNW3YU2T+ugNUtUWtoQnRvbOL9dYSaBfbjHLP1pE=\n        (signature: ph5Sj29JFG8p0rCqAXjHm+yLwiXHybxah9C1cVTI01SDeJlyXT8dbp4BfI1hFxBomgi1hOrevTpShX0f9puTCQ==)\nContent:\n  Method: staking.Transfer\n  Body:\n    To:     oasis1qrydpazemvuwtnp3efm7vmfvg3tde044qg6cxwzx\n    Amount: 1.0 TEST\n  Nonce:  1\n  Fee:\n    Amount: 0.0 TEST\n    Gas limit: 1\n    (gas price: 0.0 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: none (consensus layer)\n"})}),"\n",(0,a.jsxs)(e.p,{children:["Since the signature depends on the ",(0,a.jsx)(e.a,{href:"/core/crypto#chain-domain-separation",children:"chain domain separation context"}),", the\ntransaction above will be invalid on other networks such as the Mainnet. In this\ncase the Oasis CLI will print the ",(0,a.jsx)(e.code,{children:"[INVALID SIGNATURE]"})," warning below the\nsignature:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis transaction show testtx.json --network mainnet\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-text",metastring:"{4}",children:"Hash: c996e9d17d652d5dc64589d10806c244a5ef0f650cc2ec8c810b28a85fef5705\nSigner: NcPzNW3YU2T+ugNUtUWtoQnRvbOL9dYSaBfbjHLP1pE=\n        (signature: ph5Sj29JFG8p0rCqAXjHm+yLwiXHybxah9C1cVTI01SDeJlyXT8dbp4BfI1hFxBomgi1hOrevTpShX0f9puTCQ==)\n        [INVALID SIGNATURE]\nContent:\n  Method: staking.Transfer\n  Body:\n    To:     oasis1qrydpazemvuwtnp3efm7vmfvg3tde044qg6cxwzx\n    Amount: 1.0 ROSE\n  Nonce:  1\n  Fee:\n    Amount: 0.0 ROSE\n    Gas limit: 1\n    (gas price: 0.0 ROSE per gas unit)\n\nNetwork:  mainnet\nParaTime: none (consensus layer)\n"})}),"\n",(0,a.jsxs)(e.p,{children:["The ",(0,a.jsx)(e.code,{children:"show"})," command is also compatible with ParaTime transactions. Take the\nfollowing transaction which transfers ",(0,a.jsx)(e.code,{children:"1.0 TEST"})," from ",(0,a.jsx)(e.code,{children:"test:alice"})," to ",(0,a.jsx)(e.code,{children:"test:bob"}),"\ninside Sapphire ParaTime on the Testnet:"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",metastring:'title="testtx2.json"',children:'{\n  "Body": "o2F2AWJhaaJic2mBomVub25jZQFsYWRkcmVzc19zcGVjoWlzaWduYXR1cmWhZ2VkMjU1MTlYIDXD8zVt2FNk/roDVLVFraEJ0b2zi/XWEmgX24xyz9aRY2ZlZaJjZ2FzAWZhbW91bnSCQEBkY2FsbKJkYm9keaJidG9VAMjQ9FnbOOXMMcp35m0sRFbcvrUCZmFtb3VudIJIDeC2s6dkAABAZm1ldGhvZHFhY2NvdW50cy5UcmFuc2Zlcg==",\n  "AuthProofs": [\n    {\n      "signature": "u71xOVJhRrUth5rNTAa2HuARYCsGLmvOCRE05fCbaQiSoQhXtKPVP9feoQSXmLVxISCHr/0aNnRLEoifJLMzBQ=="\n    }\n  ]\n}\n'})}),"\n",(0,a.jsxs)(e.p,{children:["The Oasis CLI will be able to verify a transaction only for the ",(0,a.jsx)(e.strong,{children:"exact network\nand ParaTime combination"})," since both are used to derive the chain domain\nseparation context for signing the transaction."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis transaction show testtx2.json --network testnet --paratime sapphire\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Hash: 1558a5d6254a1b216a0885fa16114899e35b27622fd5af7c8b2eee7284dcad2e\nSigner(s):\n  1. NcPzNW3YU2T+ugNUtUWtoQnRvbOL9dYSaBfbjHLP1pE=\n     (signature: u71xOVJhRrUth5rNTAa2HuARYCsGLmvOCRE05fCbaQiSoQhXtKPVP9feoQSXmLVxISCHr/0aNnRLEoifJLMzBQ==)\nContent:\n  Format: plain\n  Method: accounts.Transfer\n  Body:\n    To: test:bob (oasis1qrydpazemvuwtnp3efm7vmfvg3tde044qg6cxwzx)\n    Amount: 1.0 TEST\n  Authorized signer(s):\n    1. NcPzNW3YU2T+ugNUtUWtoQnRvbOL9dYSaBfbjHLP1pE= (ed25519)\n       Nonce: 1\n  Fee:\n    Amount: 0.0 TEST\n    Gas limit: 1\n    (gas price: 0.0 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: sapphire\n"})}),"\n",(0,a.jsx)(e.h2,{id:"sign",children:"Sign a Transaction"}),"\n",(0,a.jsxs)(e.p,{children:["To sign a ",(0,a.jsx)(e.a,{href:"/build/tools/cli/account#unsigned",children:"previously unsigned transaction"})," transaction or to append\nanother signature to the transaction (",(0,a.jsx)(e.em,{children:"multisig"}),"), run\n",(0,a.jsx)(e.code,{children:"transaction sign <filename.json>"}),"."]}),"\n",(0,a.jsxs)(e.p,{children:["For example, let's transfer ",(0,a.jsx)(e.code,{children:"1.0 TEST"})," from ",(0,a.jsx)(e.code,{children:"test:alice"})," to ",(0,a.jsx)(e.code,{children:"test:bob"})," on\nTestnet consensus layer, but don't sign it and store it to\n",(0,a.jsx)(e.code,{children:"testtx_unsigned.json"}),":"]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-json",metastring:'title="testtx_unsigned.json"',children:'{\n  "nonce": 32,\n  "fee": {\n    "amount": "0",\n    "gas": 1265\n  },\n  "method": "staking.Transfer",\n  "body": "omJ0b1UAyND0Wds45cwxynfmbSxEVty+tQJmYW1vdW50RDuaygA="\n}\n'})}),"\n",(0,a.jsxs)(e.p,{children:["Comparing this transaction to ",(0,a.jsx)(e.a,{href:"#show",children:(0,a.jsx)(e.code,{children:"testtx.json"})})," which was signed, we can\nnotice that the transaction is not wrapped inside the ",(0,a.jsx)(e.code,{children:"untrusted_raw_value"}),"\nenvelope with the ",(0,a.jsx)(e.code,{children:"signature"})," field."]}),"\n",(0,a.jsx)(e.p,{children:"Decoding unsigned transaction gives us similar output:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis transaction show testtx_unsigned.json --network testnet\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Method: staking.Transfer\nBody:\n  To:     oasis1qrydpazemvuwtnp3efm7vmfvg3tde044qg6cxwzx\n  Amount: 1.0 TEST\nNonce:  32\nFee:\n  Amount: 0.0 TEST\n  Gas limit: 1265\n  (gas price: 0.0 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: none (consensus layer)\n"})}),"\n",(0,a.jsx)(e.p,{children:"Finally, let's sign the transaction:"}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis transaction sign testtx_unsigned.json --network testnet --account test:alice\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"You are about to sign the following transaction:\nMethod: staking.Transfer\nBody:\n  To:     oasis1qrydpazemvuwtnp3efm7vmfvg3tde044qg6cxwzx\n  Amount: 1.0 TEST\nNonce:  32\nFee:\n  Amount: 0.0 TEST\n  Gas limit: 1265\n  (gas price: 0.0 TEST per gas unit)\n\nNetwork:  testnet\nParaTime: none (consensus layer)\nAccount:  test:alice\n"})}),"\n",(0,a.jsxs)(e.p,{children:["We can also use ",(0,a.jsx)(e.a,{href:"/build/tools/cli/account#output-file",children:(0,a.jsx)(e.code,{children:"--output-file"})})," here and store the\nsigned transaction back to another file instead of showing it."]}),"\n",(0,a.jsx)(e.admonition,{type:"info",children:(0,a.jsxs)(e.p,{children:[(0,a.jsx)(e.a,{href:"/build/tools/cli/account#npa",children:"Network and Account"})," selectors are available for the ",(0,a.jsx)(e.code,{children:"transaction sign"}),"\ncommand."]})}),"\n",(0,a.jsx)(e.h2,{id:"submit",children:"Submit a Transaction"}),"\n",(0,a.jsxs)(e.p,{children:["Invoking ",(0,a.jsx)(e.code,{children:"transaction submit <filename.json>"})," will broadcast the consensus or\nParaTime transaction to the selected network or ParaTime. If the transaction\nhasn't been signed yet, Oasis CLI will first sign it with the selected account\nin your wallet and then broadcast it."]}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis tx submit testtx.json --network testnet --no-paratime\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Broadcasting transaction...\nTransaction executed successfully.\nTransaction hash: a81a1dcd203bba01761a55527f2c44251278110a247e63a12f064bf41e07f13a\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-shell",children:"oasis tx submit testtx2.json --network testnet --paratime sapphire\n"})}),"\n",(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{children:"Broadcasting transaction...\nTransaction included in block successfully.\nRound:            946461\nTransaction hash: 25f0b2a92b6171969e9cd41d047bc20b4e2307c3a329ddef41af73df69d95b5d\n"})})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,a.jsx)(e,{...n,children:(0,a.jsx)(l,{...n})}):l(n)}}}]);