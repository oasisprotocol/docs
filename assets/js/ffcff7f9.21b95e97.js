"use strict";(globalThis.webpackChunkdocs_oasis_io=globalThis.webpackChunkdocs_oasis_io||[]).push([[5638],{28453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>c});var i=s(96540);const a={},o=i.createContext(a);function t(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:t(e.components),i.createElement(o.Provider,{value:n},e.children)}},77375:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"core/oasis-node/cli","title":"oasis-node CLI","description":"control","source":"@site/docs/core/oasis-node/cli.md","sourceDirName":"core/oasis-node","slug":"/core/oasis-node/cli","permalink":"/core/oasis-node/cli","draft":false,"unlisted":false,"editUrl":"https://github.com/oasisprotocol/oasis-core/edit/stable/24.2.x/docs/oasis-node/cli.md","tags":[],"version":"current","lastUpdatedAt":1768997119000,"frontMatter":{"sidebar_custom_props":{}},"sidebar":"oasisCore","previous":{"title":"Metrics","permalink":"/core/oasis-node/metrics"},"next":{"title":"Common Functionality","permalink":"/core/common-functionality"}}');var a=s(74848),o=s(28453);const t={sidebar_custom_props:{tags:void 0}},c="oasis-node CLI",r={},d=[{value:"<code>control</code>",id:"control",level:2},{value:"<code>status</code>",id:"status",level:3},{value:"<code>genesis</code>",id:"genesis",level:2},{value:"<code>check</code>",id:"check",level:3},{value:"<code>dump</code>",id:"dump",level:3},{value:"<code>init</code>",id:"init",level:3},{value:"<code>stake</code>",id:"stake",level:2},{value:"<code>account</code>",id:"account",level:3},{value:"<code>info</code>",id:"info",level:4},{value:"<code>pubkey2address</code>",id:"pubkey2address",level:3},{value:"storage",id:"storage",level:2},{value:"compact-experimental",id:"compact-experimental",level:3},{value:"prune-experimental",id:"prune-experimental",level:3}];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsxs)(n.h1,{id:"oasis-node-cli",children:[(0,a.jsx)(n.code,{children:"oasis-node"})," CLI"]})}),"\n",(0,a.jsx)(n.h2,{id:"control",children:(0,a.jsx)(n.code,{children:"control"})}),"\n",(0,a.jsx)(n.h3,{id:"status",children:(0,a.jsx)(n.code,{children:"status"})}),"\n",(0,a.jsx)(n.p,{children:"Run"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node control status\n"})}),"\n",(0,a.jsx)(n.p,{children:"to get information like the following (example taken from a runtime compute\nnode):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-json",children:'{\n  "software_version": "21.3",\n  "identity": {\n    "node": "iWq6Nft6dU2GWAr9U7ICbhXWwmAINIniKzMMblSo5Xs=",\n    "p2p": "dGd+pGgIlkJb0dnkBQ7vI2EWWG81pF5M1G+jL2/6pyA=",\n    "consensus": "QaMdKVwX1da0Uf82cp0DDukQQwrSjr8BwlIxc//ANE8=",\n    "tls": [\n      "Kj8ANHwfMzcWoA1vx0OMhn4oGv8Y0vc46xMOdQUIh5c=",\n    ]\n  },\n  "consensus": {\n    "version": {\n      "major": 4\n    },\n    "backend": "tendermint",\n    "features": 3,\n    "node_peers": [\n      "5ab8074ce3053ef9b72d664c73e39972241442e3@57.71.39.73:26658",\n      "abb66e8780f3815d87bad488a2892b4d4b2221e3@108.15.34.59:50716"\n    ],\n    "latest_height": 5960191,\n    "latest_hash": "091c29c3d588c52421a4f215268c6b4ab1a7762c429a98fec5de9251f8907add",\n    "latest_time": "2021-09-24T21:42:29+02:00",\n    "latest_epoch": 10489,\n    "latest_state_root": {\n      "ns": "0000000000000000000000000000000000000000000000000000000000000000",\n      "version": 5960190,\n      "root_type": 1,\n      "hash": "c34581dcec59d80656d6082260d63f3206aef0a1b950c1f2c06d1eaa36a22ec3"\n    },\n    "genesis_height": 5891596,\n    "genesis_hash": "e9d9fb99baefc3192a866581c35bf43d7f0499c64e1c150171e87b2d5dc35087",\n    "last_retained_height": 5891596,\n    "last_retained_hash": "e9d9fb99baefc3192a866581c35bf43d7f0499c64e1c150171e87b2d5dc35087",\n    "chain_context": "9ee492b63e99eab58fd979a23dfc9b246e5fc151bfdecd48d3ba26a9d0712c2b",\n    "is_validator": true\n  },\n  "runtimes": {\n    "0000000000000000000000000000000000000000000000000000000000000001": {\n      "descriptor": {\n        "v": 2,\n        "id": "0000000000000000000000000000000000000000000000000000000000000001",\n        "entity_id": "Ldzg8aeLiUBrMYxidd5DqEzpamyV2cprmRH0pG8d/Jg=",\n        "genesis": {\n          "state_root": "c672b8d1ef56ed28ab87c3622c5114069bdd3ad7b8f9737498d0c01ecef0967a",\n          "state": null,\n          "storage_receipts": null,\n          "round": 0\n        },\n        "kind": 1,\n        "tee_hardware": 0,\n        "versions": {\n          "version": {\n            "minor": 2\n          }\n        },\n        "executor": {\n          "group_size": 3,\n          "group_backup_size": 3,\n          "allowed_stragglers": 1,\n          "round_timeout": 5,\n          "max_messages": 256\n        },\n        "txn_scheduler": {\n          "algorithm": "simple",\n          "batch_flush_timeout": 1000000000,\n          "max_batch_size": 100,\n          "max_batch_size_bytes": 1048576,\n          "propose_batch_timeout": 2000000000\n        },\n        "storage": {\n          "group_size": 3,\n          "min_write_replication": 2,\n          "max_apply_write_log_entries": 10000,\n          "max_apply_ops": 2,\n          "checkpoint_interval": 100,\n          "checkpoint_num_kept": 2,\n          "checkpoint_chunk_size": 8388608\n        },\n        "admission_policy": {\n          "any_node": {}\n        },\n        "constraints": {\n          "executor": {\n            "backup-worker": {\n              "max_nodes": {\n                "limit": 1\n              },\n              "min_pool_size": {\n                "limit": 3\n              }\n            },\n            "worker": {\n              "max_nodes": {\n                "limit": 1\n              },\n              "min_pool_size": {\n                "limit": 3\n              }\n            }\n          },\n          "storage": {\n            "worker": {\n              "max_nodes": {\n                "limit": 1\n              },\n              "min_pool_size": {\n                "limit": 3\n              }\n            }\n          }\n        },\n        "staking": {},\n        "governance_model": "entity"\n      },\n      "latest_round": 1355,\n      "latest_hash": "2a11820c0524a8a753f7f4a268ee2d0a4f4588a89121f92a43f4be9cc6acca7e",\n      "latest_time": "2021-09-24T21:41:29+02:00",\n      "latest_state_root": {\n        "ns": "0000000000000000000000000000000000000000000000000000000000000000",\n        "version": 1355,\n        "root_type": 1,\n        "hash": "45168e11548ac5322a9a206abff4368983b5cf676b1bcb2269f5dfbdf9df7be3"\n      },\n      "genesis_round": 0,\n      "genesis_hash": "aed94c03ebd2d16dfb5f6434021abf69c8c15fc69b6b19554d23da8a5a053776",\n      "committee": {\n        "latest_round": 1355,\n        "latest_height": 5960180,\n        "last_committee_update_height": 5960174,\n        "executor_roles": [\n          "worker",\n          "backup-worker"\n        ],\n        "storage_roles": [\n          "worker"\n        ],\n        "is_txn_scheduler": false,\n        "peers": [\n          "/ip4/57.71.39.73/tcp/41002/p2p/12D3KooWJvL8mYzHbcLtj91bf5sHhtrB7C8CWND5sV6Kk24eUdpQ",\n          "/ip4/108.67.32.45/tcp/26648/p2p/12D3KooWBKgcH7TGMSLuxzLxK41nTwk6DsxHRpb7HpWQXJzLurcv"\n        ]\n      },\n      "storage": {\n        "last_finalized_round": 1355\n      }\n    }\n  },\n  "registration": {\n    "last_registration": "2021-09-24T21:41:08+02:00",\n    "descriptor": {\n      "v": 1,\n      "id": "iWq6Nft6dU2GWAr9U7ICbhXWwmAINIniKzMMblSo5Xs=",\n      "entity_id": "4G4ISI8hANvMRYTbxdXU+0r9m/6ZySHERR+2RDbNOU8=",\n      "expiration": 10491,\n      "tls": {\n        "pub_key": "Kj8ANHwfMzcWoA1vx0OMhn4oGv8Y0vc46xMOdQUIh5c=",\n        "addresses": [\n          "Kj8ANHwfMzcWoA1vx0OMhn4oGv8Y0vc46xMOdQUIh5c=@128.89.215.24:30001",\n        ]\n      },\n      "p2p": {\n        "id": "dGd+pGgIlkJb0dnkBQ7vI2EWWG81pF5M1G+jL2/6pyA=",\n        "addresses": [\n          "159.89.215.24:30002"\n        ]\n      },\n      "consensus": {\n        "id": "QaMdKVwX1da0Uf82cp0DDukQQwrSjr8BwlIxc//ANE8=",\n        "addresses": [\n          "dGd+pGgIlkJb0dnkBQ7vI2EWWG81pF5M1G+jL2/6pyA=@128.89.215.24:26656"\n        ]\n      },\n      "beacon": {\n        "point": "BHg8TOqKD4wV8UCu9nICvJt7rhXFd8CxXuYiHa6X/NnzlIndzGNEJyyTr00s5rgKwX25yPmv+r2xRFbcQK6hGLE="\n      },\n      "runtimes": [\n        {\n          "id": "0000000000000000000000000000000000000000000000000000000000000001",\n          "version": {\n            "minor": 2\n          },\n          "capabilities": {},\n          "extra_info": null\n        }\n      ],\n      "roles": "compute,storage,validator"\n    },\n    "node_status": {\n      "expiration_processed": false,\n      "freeze_end_time": 0,\n      "election_eligible_after": 9810\n    }\n  },\n  "pending_upgrades": []\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"genesis",children:(0,a.jsx)(n.code,{children:"genesis"})}),"\n",(0,a.jsx)(n.h3,{id:"check",children:(0,a.jsx)(n.code,{children:"check"})}),"\n",(0,a.jsxs)(n.p,{children:["To check if a given ",(0,a.jsx)(n.a,{href:"/core/consensus/genesis#genesis-file",children:"genesis file"})," is valid, run:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node genesis check --genesis.file /path/to/genesis.json\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["This also checks if the genesis file is in the ",(0,a.jsx)(n.a,{href:"/core/consensus/genesis#canonical-form",children:"canonical form"}),"."]})}),"\n",(0,a.jsx)(n.h3,{id:"dump",children:(0,a.jsx)(n.code,{children:"dump"})}),"\n",(0,a.jsxs)(n.p,{children:["To dump the state of the network at a specific block height, e.g. 717600, to a\n",(0,a.jsx)(n.a,{href:"/core/consensus/genesis#genesis-file",children:"genesis file"}),", run:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node genesis dump \\\n  --address unix:/path/to/node/internal.sock \\\n  --genesis.file /path/to/genesis_dump.json \\\n  --height 717600\n"})}),"\n",(0,a.jsx)(n.admonition,{type:"caution",children:(0,a.jsx)(n.p,{children:"You must only run the following command after the given block height has been\nreached on the network."})}),"\n",(0,a.jsx)(n.h3,{id:"init",children:(0,a.jsx)(n.code,{children:"init"})}),"\n",(0,a.jsxs)(n.p,{children:["To initialize a new ",(0,a.jsx)(n.a,{href:"/core/consensus/genesis#genesis-file",children:"genesis file"})," with the given chain id and ",(0,a.jsx)(n.a,{href:"/core/consensus/services/staking#tokens-and-base-units",children:"staking token\nsymbol"}),", run:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'oasis-node genesis init --genesis.file /path/to/genesis.json \\\n  --chain.id "name-of-my-network" \\\n  --staking.token_symbol TEST\n'})}),"\n",(0,a.jsxs)(n.admonition,{type:"info",children:[(0,a.jsxs)(n.p,{children:["You can set a lot of parameters for the various ",(0,a.jsx)(n.a,{href:"/core/consensus/",children:"consensus layer services"}),"."]}),(0,a.jsx)(n.p,{children:"To see the full list, run:"}),(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node genesis init --help\n"})})]}),"\n",(0,a.jsx)(n.h2,{id:"stake",children:(0,a.jsx)(n.code,{children:"stake"})}),"\n",(0,a.jsx)(n.h3,{id:"account",children:(0,a.jsx)(n.code,{children:"account"})}),"\n",(0,a.jsx)(n.h4,{id:"info",children:(0,a.jsx)(n.code,{children:"info"})}),"\n",(0,a.jsx)(n.p,{children:"Run"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node stake account info \\\n  --stake.account.address <account address> \\\n  --address unix:/path/to/node/internal.sock\n"})}),"\n",(0,a.jsx)(n.p,{children:"to get staking information for a specific account:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"General Account:\n  Balance: TEST 0.0\n  Nonce: 0\nEscrow Account:\n  Active:\n    Balance: TEST 0.0\n    Total Shares: 0\n  Debonding:\n    Balance: TEST 0.0\n    Total Shares: 0\n  Commission Schedule:\n    Rates: (none)\n    Rate Bounds: (none)\n  Stake Accumulator:\n    Claims:\n      - Name: registry.RegisterEntity\n        Staking Thresholds:\n          - Global: entity\n      - Name: registry.RegisterNode.LQu4ZtFg8OJ0MC4M4QMeUR7Is6Xt4A/CW+PK/7TPiH0=\n        Staking Thresholds:\n          - Global: node-validator\n"})}),"\n",(0,a.jsx)(n.h3,{id:"pubkey2address",children:(0,a.jsx)(n.code,{children:"pubkey2address"})}),"\n",(0,a.jsx)(n.p,{children:"Run"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node stake pubkey2address --public_key <public_key>\n"})}),"\n",(0,a.jsx)(n.p,{children:"to get staking account address from an entity or node public key. Example\nresponse:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{children:"oasis1qqncl383h8458mr9cytatygctzwsx02n4c5f8ed7\n"})}),"\n",(0,a.jsx)(n.h2,{id:"storage",children:"storage"}),"\n",(0,a.jsx)(n.h3,{id:"compact-experimental",children:"compact-experimental"}),"\n",(0,a.jsx)(n.p,{children:"Run (when the node is not running):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node storage compact-experimental --config /path/to/config/file\n"})}),"\n",(0,a.jsx)(n.p,{children:"to trigger manual compaction of consensus database instances:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'{"caller":"storage.go:310","level":"info","module":"cmd/storage", \\\n"msg":"Starting database compactions. This may take a while...", \\\n"ts":"2025-10-08T09:18:22.185451554Z"}\n'})}),"\n",(0,a.jsx)(n.p,{children:"If pruning was not enabled from the start or was recently increased, then even\nafter successful pruning, the disk usage may stay the same."}),"\n",(0,a.jsx)(n.p,{children:"This is due to the LSM-tree storage design that BadgerDB uses. Concretely,\ndeleting a key only marks it as ready to be deleted (a tombstone entry). The\nactual removal of the stale data happens later during the compaction."}),"\n",(0,a.jsx)(n.p,{children:"During normal operation, compaction happens in the background. However, BadgerDB\nis intentionally lazy, trading write throughput for disk space among other\nthings. Therefore it is expected that in case of late pruning, the disk space\nmay stay constant or not be reclaimed for a very long time."}),"\n",(0,a.jsx)(n.p,{children:"This command gives operators manual control to release disk space during\nmaintenance periods."}),"\n",(0,a.jsx)(n.h3,{id:"prune-experimental",children:"prune-experimental"}),"\n",(0,a.jsx)(n.p,{children:"Run (when the node is not running):"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:"oasis-node storage prune-experimental --config /path/to/config/file\n"})}),"\n",(0,a.jsx)(n.p,{children:"to trigger manual pruning of consensus database instances:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-sh",children:'{"caller":"storage.go:433","level":"info","module":"cmd/storage", \\\n"msg":"Starting consensus databases pruning. This may take a while...", \\\n"ts":"2025-10-23T11:02:11.129822974Z"}\n'})}),"\n",(0,a.jsx)(n.p,{children:"Operators should run this whenever they change pruning configuration, e.g. when\nenabling it for the first time, or later changing it to retain less data. This\nway they guarantee the node is healthy when it starts."}),"\n",(0,a.jsxs)(n.p,{children:["Following successful pruning, to release disk space, they are encouraged to run\n",(0,a.jsx)(n.a,{href:"#compact-experimental",children:"the compaction command"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);