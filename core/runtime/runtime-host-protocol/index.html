<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-core/runtime/runtime-host-protocol" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Runtime Host Protocol | Oasis Documentation</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.oasis.io/core/runtime/runtime-host-protocol"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Runtime Host Protocol | Oasis Documentation"><meta data-rh="true" name="description" content="The Runtime Host Protocol (RHP) is a simple RPC protocol which is used to"><meta data-rh="true" property="og:description" content="The Runtime Host Protocol (RHP) is a simple RPC protocol which is used to"><link data-rh="true" rel="icon" href="/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://docs.oasis.io/core/runtime/runtime-host-protocol"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/core/runtime/runtime-host-protocol" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.oasis.io/core/runtime/runtime-host-protocol" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e55d6d10.css">
<script src="/assets/js/runtime~main.296dd946.js" defer="defer"></script>
<script src="/assets/js/main.1fc431be.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/logo.svg"><link rel="preload" as="image" href="/img/logo_dark.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Oasis Docs" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo_dark.svg" alt="Oasis Docs" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/build/">Build</a><a class="navbar__item navbar__link" href="/general/">Learn</a><a class="navbar__item navbar__link" href="/get-involved/">Get Involved</a><a class="navbar__item navbar__link" href="/node/">Run Node</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/core/">Develop Core</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub repository" aria-label="GitHub repository"></a><a href="https://oasis.net/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-www-link" title="Oasis website" aria-label="Oasis website"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/core/"><span title="Overview" class="linkLabel_WmDU">Overview</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link" href="/core/development-setup"><span title="Development Setup" class="categoryLinkLabel_W154">Development Setup</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/core/development-setup/build-environment-setup-and-building"><span title="Build Environment Setup and Building" class="categoryLinkLabel_W154">Build Environment Setup and Building</span></a><button aria-label="Expand sidebar category &#x27;Build Environment Setup and Building&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/core/development-setup/running-tests-and-development-networks"><span title="Running Tests and Development Networks" class="categoryLinkLabel_W154">Running Tests and Development Networks</span></a><button aria-label="Expand sidebar category &#x27;Running Tests and Development Networks&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--active" href="/core/high-level-components"><span title="High-Level Components" class="categoryLinkLabel_W154">High-Level Components</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/core/consensus/"><span title="Consensus Layer" class="categoryLinkLabel_W154">Consensus Layer</span></a><button aria-label="Expand sidebar category &#x27;Consensus Layer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/core/runtime/"><span title="Runtime Layer" class="categoryLinkLabel_W154">Runtime Layer</span></a><button aria-label="Collapse sidebar category &#x27;Runtime Layer&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/core/runtime/runtime-host-protocol"><span title="Runtime Host Protocol" class="linkLabel_WmDU">Runtime Host Protocol</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/core/runtime/identifiers"><span title="Runtime IDs" class="linkLabel_WmDU">Runtime IDs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/core/runtime/messages"><span title="Runtime Messages" class="linkLabel_WmDU">Runtime Messages</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/core/oasis-node"><span title="Oasis Node" class="categoryLinkLabel_W154">Oasis Node</span></a><button aria-label="Expand sidebar category &#x27;Oasis Node&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link" href="/core/common-functionality"><span title="Common Functionality" class="categoryLinkLabel_W154">Common Functionality</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/encoding"><span title="Encoding" class="linkLabel_WmDU">Encoding</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/crypto"><span title="Cryptography" class="linkLabel_WmDU">Cryptography</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/core/authenticated-grpc"><span title="Protocols" class="categoryLinkLabel_W154">Protocols</span></a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/mkvs"><span title="Merklized Key-Value Store (MKVS)" class="linkLabel_WmDU">Merklized Key-Value Store (MKVS)</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link" href="/core/processes"><span title="Processes" class="categoryLinkLabel_W154">Processes</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/release-process"><span title="Release Process" class="linkLabel_WmDU">Release Process</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/versioning"><span title="Versioning" class="linkLabel_WmDU">Versioning</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/core/SECURITY"><span title="Security" class="linkLabel_WmDU">Security</span></a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/adrs"><span title="ADRs" class="linkLabel_WmDU">ADRs</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://api.docs.oasis.io/js/client" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK"><span title="Core Client TypeScript API" class="linkLabel_WmDU">Core Client TypeScript API</span><svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK"><span title="Core Client Go API" class="linkLabel_WmDU">Core Client Go API</span><svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Runtime Host Protocol</h1></header>
<p>The Runtime Host Protocol (RHP) is a simple RPC protocol which is used to
communicate between a runtime and an Oasis Core Compute Node.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="transport">Transport<a href="#transport" class="hash-link" aria-label="Direct link to Transport" title="Direct link to Transport" translate="no">​</a></h2>
<p>The RHP assumes a reliable byte stream oriented transport underneath. The only
current implementation uses AF_LOCAL sockets and <a href="https://edp.fortanix.com/docs/api/fortanix_sgx_abi/struct.Usercalls.html#streams" target="_blank" rel="noopener noreferrer" class="">Fortanix ABI streams</a> backed
by shared memory to communicate with runtimes inside Intel SGX enclaves.</p>
<p><img decoding="async" loading="lazy" alt="Runtime Execution" src="/assets/images/oasis-core-runtime-execution-502d059c83dd21c3135c993c339f9240.svg" class="img_ev3q"></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="framing">Framing<a href="#framing" class="hash-link" aria-label="Direct link to Framing" title="Direct link to Framing" translate="no">​</a></h2>
<p>All RHP messages use simple length-value framing with the value being encoded
using <a class="" href="/core/encoding">canonical CBOR</a>. The frames are serialized on the wire as follows:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[4-byte message length (big endian)] [CBOR-serialized message]</span><br></span></code></pre></div></div>
<p>Maximum allowed message size is 16 MiB.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="messages">Messages<a href="#messages" class="hash-link" aria-label="Direct link to Messages" title="Direct link to Messages" translate="no">​</a></h2>
<p>Each <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Message" target="_blank" rel="noopener noreferrer" class="">message</a> can be either a request or a response as specified by the type
field. Each request is assigned a unique 64-bit sequence number by the caller to
make it possible to correlate responses.</p>
<p>See the API reference (<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Body" target="_blank" rel="noopener noreferrer" class="">Go</a>, <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime/src/types.rs" target="_blank" rel="noopener noreferrer" class="">Rust</a>) for a list of all supported message bodies.
In case the request resulted in an error, the special <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Error" target="_blank" rel="noopener noreferrer" class=""><code>Error</code></a> response body
must be used.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="operation">Operation<a href="#operation" class="hash-link" aria-label="Direct link to Operation" title="Direct link to Operation" translate="no">​</a></h2>
<p>RHP allows two forms of communication:</p>
<ul>
<li class="">
<p><strong>Host-to-runtime</strong> where the host (compute node) submits requests to the
runtime to handle and the runtime provides responses. All such request
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Body" target="_blank" rel="noopener noreferrer" class="">messages</a> are prefixed with <code>Runtime</code>.</p>
</li>
<li class="">
<p><strong>Runtime-to-host</strong> where the runtime submits requests to the host and the
host provides responses. All such request <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Body" target="_blank" rel="noopener noreferrer" class="">messages</a> are prefixed with
<code>Host</code>.</p>
</li>
</ul>
<p>In its lifetime, from connection establishment to its termination, the RHP
connection goes through the following states:</p>
<ul>
<li class="">
<p><em>Uninitialized</em> is the default state of a newly created connection. In this
state the connection could be used either on the runtime side or the host
side. To proceed to the next state, the connection must be initialized either
as a runtime or as a host. The <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer" class="">Rust implementation</a> only supports runtime
mode while the <a href="https://github.com/oasisprotocol/oasis-core/tree/master/go/runtime/host/protocol" target="_blank" rel="noopener noreferrer" class="">Go implementation</a> can be initialized in either mode by using
either <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#Connection" target="_blank" rel="noopener noreferrer" class=""><code>InitHost</code> or <code>InitGuest</code></a>.</p>
</li>
<li class="">
<p><em>Initializing</em> is the state when the connection is being initialized (see
below for details). After a connection has been successfully initialized it
will transition into <em>ready</em> state. If the initialization failed, it will
instead transition into <em>closed</em> state.</p>
</li>
<li class="">
<p><em>Ready</em> is the state when the connection can be used to exchange messages in
either direction.</p>
</li>
<li class="">
<p><em>Closed</em> is the state of the connection after it is considered closed. No
messages may be exchanged at this point.</p>
</li>
</ul>
<p>If either the runtime or the host generates an invalid message, either end may
terminate the connection (and/or the runtime process).</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="initialization">Initialization<a href="#initialization" class="hash-link" aria-label="Direct link to Initialization" title="Direct link to Initialization" translate="no">​</a></h3>
<p>Before a connection can be used, it must be initialized as either representing
the runtime end or the host (compute node) end. The <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer" class="">Rust implementation</a> only
supports being initialized as the runtime and the <a href="https://github.com/oasisprotocol/oasis-core/tree/master/go/runtime/host/protocol" target="_blank" rel="noopener noreferrer" class="">Go implementation</a> is
currently only used as the host. If one uses the <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer" class=""><code>oasis-core-runtime</code> crate</a>
to build a runtime, initialization is handled automatically.</p>
<p>The initialization procedure is driven by the host and it proceeds as follows:</p>
<ul>
<li class="">
<p>The host sends <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeInfoRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeInfoRequest</code></a> providing the runtime with its
<a class="" href="/core/runtime/identifiers">designated identifier</a>. The identifier comes from the <a class="" href="/core/consensus/services/registry#runtimes">registry service</a> in
the consensus layer.</p>
</li>
<li class="">
<p>The runtime must reply with a <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeInfoResponse" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeInfoResponse</code></a> specifying its own
version and the version of the runtime host protocol that it supports. If the
protocol version is incompatible, initialization fails.</p>
</li>
</ul>
<p>After the initialization procedure, the connection can be used for other
messages. In case the runtime is running in a trusted execution environment
(TEE) like Intel SGX, the next required step is to perform remote attestation.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="remote-attestation">Remote Attestation<a href="#remote-attestation" class="hash-link" aria-label="Direct link to Remote Attestation" title="Direct link to Remote Attestation" translate="no">​</a></h3>
<p>When a runtime is executed in a TEE, it must perform remote attestation
immediately after initialization. The <a href="https://github.com/oasisprotocol/oasis-core/tree/master/runtime" target="_blank" rel="noopener noreferrer" class="">Rust implementation</a> also requires that
remote attestation is periodically renewed and will start rejecting requests
otherwise. In case a runtime is not executed in a TEE, this step is skipped.</p>
<p><em>NOTE: As currently Intel SGX is the only supported TEE, the elements of the
remote attestation protocol are in some parts very specific to Intel SGX. This
may change in the future when support for additional TEEs is added.</em></p>
<p>Upon initialization the host performs the following steps:</p>
<ul>
<li class="">
<p><em>[Intel SGX]</em> The host obtains information for the runtime to be able to
generate an attestation report. This includes talking to the AESM service and
the IAS configuration. The information includes the identity of the Quoting
Enclave.</p>
</li>
<li class="">
<p>The host sends <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakInitRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeCapabilityTEERakInitRequest</code></a> passing the information
required for the runtime to initialize its own ephemeral Runtime Attestation
Key (RAK). The RAK is valid for as long as the runtime is running.</p>
</li>
</ul>
<p>The initialization then proceeds as follows, with the following steps also
being performed as part of periodic re-attestation:</p>
<ul>
<li class="">
<p>The host sends <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakReportRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeCapabilityTEERakReportRequest</code></a> requesting the runtime
to generate an attestation report.</p>
</li>
<li class="">
<p>The runtime prepares an attestation report based on the information provided
during the first initialization step. It responds with
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakReportResponse" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeCapabilityTEERakReportResponse</code></a> containing the public part of the
RAK, the attestation report (binding RAK to the TEE identity) and a replay
protection nonce.</p>
</li>
<li class="">
<p><em>[Intel SGX]</em> The host proceeds to submit the attestation report to the
Quoting Enclave to receive a quote. It submits the received quote to the
Intel Attestation Service (IAS) to receive a signed Attestation Verification
Report (AVR). It submits the AVR to the runtime by sending a
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCapabilityTEERakAvrRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeCapabilityTEERakAvrRequest</code></a>.</p>
</li>
<li class="">
<p><em>[Intel SGX]</em> The runtime verifies the validity of the AVR, making sure that
it is not a replay and that it in fact contains the correct enclave identity
and the RAK binding.</p>
</li>
<li class="">
<p>Upon successful verification the runtime is now ready to accept requests. As
mentioned the attestation procedure must be performed periodically by the host
as otherwise the runtime may start rejecting requests.</p>
</li>
</ul>
<p>The compute node will submit remote attestation information to the consensus
<a class="" href="/core/consensus/services/registry#runtimes">registry service</a> as part of its <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/common/node?tab=doc#Node" target="_blank" rel="noopener noreferrer" class="">node registration descriptor</a>. The registry
service will verify that the submitted AVR is in fact valid and corresponds to
the registered runtime enclave identity. It will reject node registrations
otherwise.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="host-to-runtime">Host-to-runtime<a href="#host-to-runtime" class="hash-link" aria-label="Direct link to Host-to-runtime" title="Direct link to Host-to-runtime" translate="no">​</a></h3>
<p>The following section describes the calls that a host can make to request
processing from the runtime after successfully performing initialization (and
initial remote attestation if running in a TEE).</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="transaction-batch-dispatch">Transaction Batch Dispatch<a href="#transaction-batch-dispatch" class="hash-link" aria-label="Direct link to Transaction Batch Dispatch" title="Direct link to Transaction Batch Dispatch" translate="no">​</a></h4>
<p>When a compute node needs to verify whether individual transactions are valid
it can optionally request the runtime to perform a simplified transaction check.
It can do this by sending a <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeCheckTxBatchRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeCheckTxBatchRequest</code></a> message. The runtime
should perform the required non-expensive checks, but should not fully execute
the transactions.</p>
<p>When a compute node receives a batch of transactions to process from the
transaction scheduler executor, it passes the batch to the runtime via the
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeExecuteTxBatchRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeExecuteTxBatchRequest</code></a> message. The runtime must execute the
transactions in the given batch and produce a set of state changes (storage
updates for the output and state roots). In case the runtime is running in a TEE
the execution results must be signed by the Runtime Attestation Key (see above).</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="enclaverpc">EnclaveRPC<a href="#enclaverpc" class="hash-link" aria-label="Direct link to EnclaveRPC" title="Direct link to EnclaveRPC" translate="no">​</a></h4>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-manager-policy-update">Key Manager Policy Update<a href="#key-manager-policy-update" class="hash-link" aria-label="Direct link to Key Manager Policy Update" title="Direct link to Key Manager Policy Update" translate="no">​</a></h4>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="abort">Abort<a href="#abort" class="hash-link" aria-label="Direct link to Abort" title="Direct link to Abort" translate="no">​</a></h4>
<p>The host can request the runtime to abort processing the current batch by
sending the <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeAbortRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeAbortRequest</code></a> message. The request does not take any
arguments. In case the response does not indicate an error the abort is deemed
successful by the host.</p>
<p>In case the runtime does not reply quickly enough the host may terminate the
runtime and start a new instance.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="extensions">Extensions<a href="#extensions" class="hash-link" aria-label="Direct link to Extensions" title="Direct link to Extensions" translate="no">​</a></h4>
<p>RHP provides a way for runtimes to support custom protocol extensions by
utilizing the <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeLocalRPCCallRequest" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeLocalRPCCallRequest</code></a> and <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#RuntimeLocalRPCCallResponse" target="_blank" rel="noopener noreferrer" class=""><code>RuntimeLocalRPCCallResponse</code></a>
messages.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="runtime-to-host">Runtime-to-host<a href="#runtime-to-host" class="hash-link" aria-label="Direct link to Runtime-to-host" title="Direct link to Runtime-to-host" translate="no">​</a></h3>
<p>The following section describes the calls that a runtime can make to request
processing from the host (or the wider distributed network on host&#x27;s behalf).</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="enclaverpc-to-remote-endpoints">EnclaveRPC to Remote Endpoints<a href="#enclaverpc-to-remote-endpoints" class="hash-link" aria-label="Direct link to EnclaveRPC to Remote Endpoints" title="Direct link to EnclaveRPC to Remote Endpoints" translate="no">​</a></h4>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="read-only-runtime-storage-access">Read-only Runtime Storage Access<a href="#read-only-runtime-storage-access" class="hash-link" aria-label="Direct link to Read-only Runtime Storage Access" title="Direct link to Read-only Runtime Storage Access" translate="no">​</a></h4>
<p>The host exposes the <a class="" href="/core/mkvs#read-syncer">MKVS read syncer</a> interface (via the
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#HostStorageSyncRequest" target="_blank" rel="noopener noreferrer" class=""><code>HostStorageSyncRequest</code></a> message) to enable runtimes read-only access to
global runtime storage.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="untrusted-local-storage-access">Untrusted Local Storage Access<a href="#untrusted-local-storage-access" class="hash-link" aria-label="Direct link to Untrusted Local Storage Access" title="Direct link to Untrusted Local Storage Access" translate="no">​</a></h4>
<p>The host exposes a simple key-value local store that can be used by the runtime
to store arbitrary instance-specific data. <strong>Note that if the runtime is running
in a TEE this store must be treated as UNTRUSTED as the host may perform
arbitrary attacks. The runtime should use TEE-specific sealing to ensure
integrity and confidentiality of any stored data.</strong></p>
<p>There are two local storage operations, namely get and set, exposed via
<a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#HostLocalStorageGetRequest" target="_blank" rel="noopener noreferrer" class=""><code>HostLocalStorageGetRequest</code></a> and <a href="https://pkg.go.dev/github.com/oasisprotocol/oasis-core/go/runtime/host/protocol?tab=doc#HostLocalStorageSetRequest" target="_blank" rel="noopener noreferrer" class=""><code>HostLocalStorageSetRequest</code></a> messages,
respectively.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/oasisprotocol/oasis-core/edit/stable/24.2.x/docs/runtime/runtime-host-protocol.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-09-11T06:14:05.000Z" itemprop="dateModified">Sep 11, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/core/runtime/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Runtime Layer</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/core/runtime/identifiers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Runtime IDs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#transport" class="table-of-contents__link toc-highlight">Transport</a></li><li><a href="#framing" class="table-of-contents__link toc-highlight">Framing</a></li><li><a href="#messages" class="table-of-contents__link toc-highlight">Messages</a></li><li><a href="#operation" class="table-of-contents__link toc-highlight">Operation</a><ul><li><a href="#initialization" class="table-of-contents__link toc-highlight">Initialization</a></li><li><a href="#remote-attestation" class="table-of-contents__link toc-highlight">Remote Attestation</a></li><li><a href="#host-to-runtime" class="table-of-contents__link toc-highlight">Host-to-runtime</a></li><li><a href="#runtime-to-host" class="table-of-contents__link toc-highlight">Runtime-to-host</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Tools</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://explorer.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Explorer</a></li><li class="footer__item"><a href="https://wallet.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Wallet</a></li><li class="footer__item"><a href="https://github.com/oasisprotocol/cli" target="_blank" rel="noopener noreferrer" class="footer__link-item">CLI</a></li><li class="footer__item"><a href="https://status.oasis.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Status</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Build</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://faucet.testnet.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Testnet Faucet</a></li><li class="footer__item"><a href="https://playground.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Playground</a></li><li class="footer__item"><a href="https://api.docs.oasis.io/" target="_blank" rel="noopener noreferrer" class="footer__link-item">API</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Node</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/node/network/mainnet">Mainnet</a></li><li class="footer__item"><a class="footer__link-item" href="/node/network/testnet">Testnet</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://oasis.io/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://t.me/oasisprotocolcommunity" target="_blank" rel="noopener noreferrer" class="footer__link-item">Telegram</a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UC35UFPcZ2F1wjPxhPrSsESQ" target="_blank" rel="noopener noreferrer" class="footer__link-item">Youtube</a></li><li class="footer__item"><a href="https://github.com/oasisprotocol" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">
<p xmlns:cc="http://creativecommons.org/ns#">Copyright © 2025
by <a rel="cc:attributionURL dct:creator" property="cc:attributionName" href="https://oasis.net">
Oasis Protocol Foundation</a>. We <a href="https://oasisprotocol.org/privacy-policy" target="_blank" rel="noopener noreferrer">respect your privacy</a>.
Unless otherwise specified, all text and images on this website are licensed
under <a href="http://creativecommons.org/licenses/by/4.0/?ref=chooser-v1" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
CC BY 4.0<img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="/img/cc.svg"><img style="height:22px!important;margin-left:3px;vertical-align:text-bottom;" src="/img/by.svg"></a>.
This does not include the Oasis software and the code examples, both of which are
licensed under <a href="https://www.apache.org/licenses/LICENSE-2.0" target="_blank" rel="license noopener noreferrer" style="display:inline-block;">
Apache 2.0</a>. Built with &#x2665; and Docusaurus.</p></div></div></div></footer><!--$--><!--/$--></div>
</body>
</html>